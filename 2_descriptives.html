<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Descriptives</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="site_libs/d3-3.3.8/d3.min.js"></script>
<script src="site_libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="site_libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="site_libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/chromatography-0.1/chromatography.js"></script>
<script src="site_libs/DiagrammeR-binding-1.0.0/DiagrammeR.js"></script>
<script src="library/auto_tab_first_section.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Fertility diary</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="1_power_analysis.html">Power analysis</a>
</li>
<li>
  <a href="1_researcher_df_analysis.html">Researcher degree of freedom simulation</a>
</li>
<li>
  <a href="1_wrangle_data.html">Data wrangling</a>
</li>
<li>
  <a href="2_descriptives.html">Descriptives</a>
</li>
<li>
  <a href="3_fertility_as_prereg.html">Preregistered analyses</a>
</li>
<li>
  <a href="3_fertility_robustness.html">Robustness tests</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="descriptives" class="section level1 tab-content">
<h1>Descriptives</h1>
<p><span style="background:red;width:20px;height:20px;display:inline-block;"></span> Cycling women (not on hormonal birth control)</p>
<p><span style="background:black;width:20px;height:20px;display:inline-block;"></span> Women on hormonal birth control</p>
<pre class="r"><code>library(knitr)
opts_chunk$set(fig.width = 9, fig.height = 7, cache = T, warning = F, message = F, render = formr::pander_handler, error = TRUE)</code></pre>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)
load(&quot;full_data.rdata&quot;)
hcfacet = facet_wrap(~ hormonal_contraception, labeller = as_labeller(c(&quot;0&quot; = &quot;Naturally cycling&quot;, &quot;1&quot; = &quot;Hormonal contraception user&quot;)))</code></pre>
<div id="exclusion-criteria-participant-flow" class="section level2 tab-content">
<h2>Exclusion criteria, participant flow</h2>
<p>After this section, descriptives are only on women who are included.</p>
<div id="participant-flow" class="section level3">
<h3>Participant flow</h3>
<pre class="r"><code>library(DiagrammeR)
load(&quot;pipeline.rdata&quot;)
consort = with(pipeline,
paste0(&#39;graph TB
  start[&quot;Participants enrolled&lt;br&gt;
  N=&#39;,signed_up,&#39;&quot;]
  ineligible[&quot;Ineligible&lt;br&gt;
  n=&#39;,ineligible,&#39;&quot;]
  notfinish[&quot;Did not finish pre-survey&lt;br&gt;
  n=&#39;,did_not_complete_pre_survey,&#39;&quot;]
  eligible[&quot;Finished pre-survey&lt;br&gt;
  n=&#39;,finished_pre_survey,&#39;&quot;]

  horm_ineligible[&quot;Excluded n=&#39;,never_did_diary,&#39; no diary entries,&lt;br&gt;
  n=&#39;,pregnant,&#39; pregnant, n=&#39;,infertile,&#39; infertile,&lt;br&gt;
  n=&#39;,sterilised,&#39; sterilised,&lt;br&gt;
  n=&#39;,fertility_not_estimable,&#39; fertility not estimable&quot;]

  nc[&quot;Naturally cycling&lt;br&gt;
  n=&#39;,naturally_cycling,&#39;&quot;]

  hc[&quot;Using hormonal contraception&lt;br&gt;
  n=&#39;,hc$HC_users,&#39;&quot;]

  c_lax_ineligible[&quot;Excluded n=&#39;,older_than_40,&#39; older than 40, &lt;br&gt;
  n=&#39;,finished_post_survey,&#39; did not finish study, &lt;br&gt;
  n=&#39;,hc_users_broad,&#39; used morning-after-pill, &lt;br&gt;
  n=&#39;,breast_feeding,&#39; breast-feeding, &lt;br&gt;
  n=&#39;,pill_last_3m,&#39; HC used in last 3m, &lt;br&gt;
  n=&#39;,hormonal_medicine,&#39; hormonal medication, &lt;br&gt;
  n=&#39;,long_or_short_cycle,&#39; cycle length not in 22-37 days, &lt;br&gt;
  n=&#39;,guessed_hypothesis,&#39; guessed a hypothesis, &lt;br&gt;
  n=&#39;,laggards,&#39; took more &gt;70 days or &lt;br&gt;
interrupted for &gt;10 days&quot;]

  c_lax[&quot;Included (lax)&lt;br&gt;
  n=&#39;,criterion_lax,&#39;&quot;]

  c_cons_ineligible[&quot;Excluded n=&#39;,heavy_smokers,&#39; heavy smokers, &lt;br&gt;
  n=&#39;,intensive_sports,&#39; did intensive sports, &lt;br&gt;
  n=&#39;,changed_contraception,&#39; changed contraception,&lt;br&gt;
  n=&#39;,broke_up,&#39; broke up, n=&#39;,lost_more_than_8kg,&#39; lost &gt; 8kg, &lt;br&gt;
  n=&#39;,BMI_lt_17,&#39; BMI &lt; 17, n=&#39;,BMI_gt_30,&#39; BMI &gt; 30, &lt;br&gt;
  n=&#39;,confident_that_cycle_irregular,&#39; irregular cycle (confident)&quot;]

  c_cons[&quot;Included (conservative)&lt;br&gt;
  n=&#39;,criterion_conservative,&#39;&quot;]

  c_strict_ineligible[&quot;Excluded n=&#39;,stressed,&#39; stressed, &lt;br&gt;
  n=&#39;,cycle_possibly_irregular,&#39; possibly irregular cycle&quot;]

  c_strict[&quot;Included (strict)&lt;br&gt;
  n=&#39;,criterion_strict,&#39;&quot;]

  hc_lax_ineligible[&quot;Excluded n=&#39;,hc$older_than_40,&#39; older than 40,&lt;br&gt;
  n=&#39;,hc$finished_post_survey,&#39; did not finish study, &lt;br&gt;
  n=&#39;,hc$breast_feeding,&#39; breast-feeding, &lt;br&gt;
  n=&#39;,hc$long_or_short_cycle,&#39; cycle length not in 22-37 days, &lt;br&gt;
  n=&#39;,hc$guessed_hypothesis,&#39; guessed a hypothesis, &lt;br&gt;
  n=&#39;,hc$laggards,&#39; took more &gt;70 days or &lt;br&gt;
interrupted for &gt;10 days&quot;]

  hc_lax[&quot;Included (lax)&lt;br&gt;
  n=&#39;,hc$criterion_lax,&#39;&quot;]

  hc_cons_ineligible[&quot;Excluded n=&#39;,hc$heavy_smokers,&#39; heavy smokers, &lt;br&gt;
  n=&#39;,hc$intensive_sports,&#39; did intensive sports, &lt;br&gt;
  n=&#39;,hc$changed_contraception,&#39; changed contraception,&lt;br&gt;
  n=&#39;,hc$broke_up,&#39; broke up, n=&#39;,hc$lost_more_than_8kg,&#39; lost &gt; 8kg, &lt;br&gt;
  n=&#39;,hc$BMI_lt_17,&#39; BMI &lt; 17, n=&#39;,hc$BMI_gt_30,&#39; BMI &gt; 30, &lt;br&gt;
  n=&#39;,hc$confident_that_cycle_irregular,&#39; irregular cycle (confident)&quot;]

  hc_cons[&quot;Included (conservative)&lt;br&gt;
  n=&#39;,hc$criterion_conservative,&#39;&quot;]

  hc_strict_ineligible[&quot;Excluded n=&#39;,hc$stressed,&#39; stressed, &lt;br&gt;
  n=&#39;,hc$cycle_possibly_irregular,&#39; possibly irregular cycle&quot;]

  hc_strict[&quot;Included (strict)&lt;br&gt;
  n=&#39;,hc$criterion_strict,&#39;&quot;]



  start --&gt; ineligible
  start --&gt; eligible
  start --&gt; notfinish
  eligible --&gt; hc
  eligible --&gt; horm_ineligible
  eligible --&gt; nc
  nc --&gt; c_lax
  nc --&gt; c_lax_ineligible
  hc --&gt; hc_lax_ineligible
  hc --&gt; hc_lax
  c_lax --&gt; c_cons
  c_lax --&gt; c_cons_ineligible
  hc_lax --&gt; hc_cons_ineligible
  hc_lax --&gt; hc_cons
  c_cons --&gt; c_strict
  c_cons --&gt; c_strict_ineligible
  hc_cons --&gt; hc_strict_ineligible
  hc_cons --&gt; hc_strict

classDef default fill:#fff,stroke:#000,stroke-width:1px
&#39;)
)
mermaid(consort, width = 1400, height = 900)</code></pre>
<div id="htmlwidget-b9f28bf7672e4bd0aa27" style="width:1400px;height:900px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-b9f28bf7672e4bd0aa27">{"x":{"diagram":"graph TB\n  start[\"Participants enrolled<br>\n  N=1720\"]\n  ineligible[\"Ineligible<br>\n  n=259\"]\n  notfinish[\"Did not finish pre-survey<br>\n  n=253\"]\n  eligible[\"Finished pre-survey<br>\n  n=1208\"]\n\n  horm_ineligible[\"Excluded n=54 no diary entries,<br>\n  n=24 pregnant, n=5 infertile,<br>\n  n=12 sterilised,<br>\n  n=59 fertility not estimable\"]\n\n  nc[\"Naturally cycling<br>\n  n=429\"]\n\n  hc[\"Using hormonal contraception<br>\n  n=625\"]\n\n  c_lax_ineligible[\"Excluded n=54 older than 40, <br>\n  n=137 did not finish study, <br>\n  n=2 used morning-after-pill, <br>\n  n=6 breast-feeding, <br>\n  n=14 HC used in last 3m, <br>\n  n=25 hormonal medication, <br>\n  n=10 cycle length not in 22-37 days, <br>\n  n=21 guessed a hypothesis, <br>\n  n=17 took more >70 days or <br>\ninterrupted for >10 days\"]\n\n  c_lax[\"Included (lax)<br>\n  n=143\"]\n\n  c_cons_ineligible[\"Excluded n=4 heavy smokers, <br>\n  n=6 did intensive sports, <br>\n  n=0 changed contraception,<br>\n  n=3 broke up, n=2 lost > 8kg, <br>\n  n=3 BMI < 17, n=8 BMI > 30, <br>\n  n=5 irregular cycle (confident)\"]\n\n  c_cons[\"Included (conservative)<br>\n  n=112\"]\n\n  c_strict_ineligible[\"Excluded n=43 stressed, <br>\n  n=12 possibly irregular cycle\"]\n\n  c_strict[\"Included (strict)<br>\n  n=57\"]\n\n  hc_lax_ineligible[\"Excluded n=10 older than 40,<br>\n  n=168 did not finish study, <br>\n  n=2 breast-feeding, <br>\n  n=28 cycle length not in 22-37 days, <br>\n  n=19 guessed a hypothesis, <br>\n  n=24 took more >70 days or <br>\ninterrupted for >10 days\"]\n\n  hc_lax[\"Included (lax)<br>\n  n=374\"]\n\n  hc_cons_ineligible[\"Excluded n=10 heavy smokers, <br>\n  n=18 did intensive sports, <br>\n  n=14 changed contraception,<br>\n  n=10 broke up, n=6 lost > 8kg, <br>\n  n=7 BMI < 17, n=10 BMI > 30, <br>\n  n=6 irregular cycle (confident)\"]\n\n  hc_cons[\"Included (conservative)<br>\n  n=293\"]\n\n  hc_strict_ineligible[\"Excluded n=120 stressed, <br>\n  n=12 possibly irregular cycle\"]\n\n  hc_strict[\"Included (strict)<br>\n  n=161\"]\n\n\n\n  start --> ineligible\n  start --> eligible\n  start --> notfinish\n  eligible --> hc\n  eligible --> horm_ineligible\n  eligible --> nc\n  nc --> c_lax\n  nc --> c_lax_ineligible\n  hc --> hc_lax_ineligible\n  hc --> hc_lax\n  c_lax --> c_cons\n  c_lax --> c_cons_ineligible\n  hc_lax --> hc_cons_ineligible\n  hc_lax --> hc_cons\n  c_cons --> c_strict\n  c_cons --> c_strict_ineligible\n  hc_cons --> hc_strict_ineligible\n  hc_cons --> hc_strict\n\nclassDef default fill:#fff,stroke:#000,stroke-width:1px\n"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="exclusion-by-hormonal-contraception" class="section level3">
<h3>Exclusion by hormonal contraception</h3>
<pre class="r"><code>bar_count(xsection, included_levels)</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>bar_count(xsection, included_levels) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code>xtabs(~ dodgy_data + included_levels, data = diary)</code></pre>
<pre><code>##           included_levels
## dodgy_data   all   lax conservative strict
##      FALSE 10192  3655         6261   7465
##      TRUE    577   158          204    217</code></pre>
<pre class="r"><code>xsection2 = xsection
xsection = xsection %&gt;% filter(!is.na(included_all)) %&gt;% mutate(duration_relationship_total = duration_relationship_total/12)
diary = diary %&gt;% filter(!is.na(included_all))</code></pre>
</div>
</div>
<div id="data-collection" class="section level2">
<h2>Data collection</h2>
<p>First included participant enrolled on 2014-03-19, last participant enrolled on 2015-07-02. Last diary entry on 2015-12-03.</p>
</div>
<div id="tables" class="section level2">
<h2>Tables</h2>
<pre class="r"><code>options(digits = 2)
xsection %&gt;% 
  select(age, religiosity, first_time, menarche, duration_relationship_total, cycle_length, number_sexual_partner) %&gt;%
  gather(variable, value) %&gt;%
  group_by(variable) %&gt;%
  filter(!is.na(value)) %&gt;% 
  summarise(mean = form(mean(value), 1), sd = form(sd(value),1), 
            median = median(value),
            min = min(value), max  = max(value)) %&gt;% 
  pander()</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<table style="width:93%;">
<colgroup>
<col width="41%" />
<col width="9%" />
<col width="9%" />
<col width="12%" />
<col width="8%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">variable</th>
<th align="center">mean</th>
<th align="center">sd</th>
<th align="center">median</th>
<th align="center">min</th>
<th align="center">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">age</td>
<td align="center">25.8</td>
<td align="center">6.9</td>
<td align="center">24</td>
<td align="center">18</td>
<td align="center">69</td>
</tr>
<tr class="even">
<td align="center">cycle_length</td>
<td align="center">28.4</td>
<td align="center">3.3</td>
<td align="center">28</td>
<td align="center">20</td>
<td align="center">40</td>
</tr>
<tr class="odd">
<td align="center">duration_relationship_total</td>
<td align="center">3.9</td>
<td align="center">4.6</td>
<td align="center">2.5</td>
<td align="center">0</td>
<td align="center">34.25</td>
</tr>
<tr class="even">
<td align="center">first_time</td>
<td align="center">16.9</td>
<td align="center">2.3</td>
<td align="center">17</td>
<td align="center">10</td>
<td align="center">29</td>
</tr>
<tr class="odd">
<td align="center">menarche</td>
<td align="center">13.0</td>
<td align="center">1.4</td>
<td align="center">13</td>
<td align="center">9</td>
<td align="center">19</td>
</tr>
<tr class="even">
<td align="center">number_sexual_partner</td>
<td align="center">7.2</td>
<td align="center">11.1</td>
<td align="center">4</td>
<td align="center">0</td>
<td align="center">150</td>
</tr>
<tr class="odd">
<td align="center">religiosity</td>
<td align="center">2.0</td>
<td align="center">1.1</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">5</td>
</tr>
</tbody>
</table>
<pre class="r"><code># options(digits = 4)

# xsection %&gt;% 
#   select(age, religiosity, first_time, menarche, duration_relationship_total, cycle_length, number_sexual_partner) %&gt;%
#   gather(variable, value) %&gt;%
#   group_by(variable) %&gt;%
#   filter(!is.na(value)) %&gt;% 
#   summarise(mean = round(mean(value),1), sd = round(sd(value),1), 
#             median = median(value),
#             min = min(value), max  = round(max(value))) %&gt;%
#   stargazer::stargazer(summary = FALSE, rownames = F, label = &quot;Descriptive statistics&quot;, align = T, header = F, digits = 1, digits.extra = 1)</code></pre>
</div>
<div id="comparison-with-quasi-control-group" class="section level2 tab-content">
<h2>Comparison with quasi-control group</h2>
<pre class="r"><code>comps = data_frame(var = character(0), 
                   `HC user - Mean (SD)` = character(0), 
                   `Cycling - Mean (SD)` = character(0),
                   hedges_g = character(0),
                   p_value = character(0)
)</code></pre>
<pre><code>## Warning: `data_frame()` is deprecated, use `tibble()`.
## This warning is displayed once per session.</code></pre>
<pre class="r"><code>compare_by_group = function(var, data) {
 sd_hc = sd(data[data$hormonal_contraception == 1,][[var]], na.rm = T)
 sd_nc = sd(data[data$hormonal_contraception == 0,][[var]], na.rm = T)
  data$hormonal_contraception = factor(if_else(data$hormonal_contraception == 1, &quot;hormonal contraceptive user&quot;, &quot;naturally cycling&quot;))
 comp = as.formula(paste0(var, &quot; ~ hormonal_contraception&quot;))
 tt = t.test(comp, data = data)
 print(tt)
 eff = effsize::cohen.d(comp, data = data, hedges.correction = TRUE, na.rm = T, pooled = FALSE)
 print(eff)
 
 summary = data_frame(var = var, 
                   `HC user - Mean (SD)` = paste0(form(tt$estimate[1], 1),&quot; (&quot;, form(sd_hc, 1),&quot;)&quot;), 
                   `Cycling - Mean (SD)` = paste0(form(tt$estimate[2], 1), &quot; (&quot;, form(sd_nc, 1), &quot;)&quot;),
                   hedges_g = form(eff$estimate),
                   p_value = pvalues(tt$p.value)
)
 rownames(summary) = NULL
 comps &lt;&lt;- bind_rows(comps, summary)

ggplot(data, aes_string(var, colour = &quot;hormonal_contraception&quot;, fill = &quot;hormonal_contraception&quot;)) + 
  geom_density(alpha = 0.3, size = 0) +
  scale_color_manual(&quot;&quot;, values = c(&quot;naturally cycling&quot; = &quot;red&quot;, &quot;hormonal contraceptive user&quot; = &quot;black&quot;), guide = F) +
  scale_fill_manual(&quot;&quot;, values = c(&quot;naturally cycling&quot; = &quot;red&quot;, &quot;hormonal contraceptive user&quot; = &quot;black&quot;), guide = F) 
}</code></pre>
<div id="age" class="section level3">
<h3>Age</h3>
<pre class="r"><code>compare_by_group(&quot;age&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  age by hormonal_contraception
## t = -10, df = 600, p-value &lt;2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -6.0 -4.3
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                        24                                        29 
## 
## 
## Hedges&#39;s g
## 
## g estimate: -0.61 (medium)
## 95 percent confidence interval:
## lower upper 
## -0.74 -0.49</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="religiosity" class="section level3">
<h3>Religiosity</h3>
<pre class="r"><code>compare_by_group(&quot;religiosity&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  religiosity by hormonal_contraception
## t = -0.09, df = 900, p-value = 0.9
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.15  0.13
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                         2                                         2 
## 
## 
## Hedges&#39;s g
## 
## g estimate: -0.0053 (negligible)
## 95 percent confidence interval:
## lower upper 
## -0.13  0.12</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="age-at-first-time" class="section level3">
<h3>Age at first time</h3>
<pre class="r"><code>compare_by_group(&quot;first_time&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  first_time by hormonal_contraception
## t = 0.03, df = 800, p-value = 1
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.29  0.30
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                        17                                        17 
## 
## 
## Hedges&#39;s g
## 
## g estimate: 0.0018 (negligible)
## 95 percent confidence interval:
## lower upper 
## -0.12  0.13</code></pre>
<pre><code>## Warning: Removed 29 rows containing non-finite values (stat_density).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="age-at-menarche" class="section level3">
<h3>Age at menarche</h3>
<pre class="r"><code>compare_by_group(&quot;menarche&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  menarche by hormonal_contraception
## t = 0.7, df = 400, p-value = 0.5
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.17  0.35
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                        13                                        13 
## 
## 
## Hedges&#39;s g
## 
## g estimate: 0.061 (negligible)
## 95 percent confidence interval:
## lower upper 
## -0.12  0.24</code></pre>
<pre><code>## Warning: Removed 586 rows containing non-finite values (stat_density).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="relationship-duration" class="section level3">
<h3>Relationship duration</h3>
<pre class="r"><code>compare_by_group(&quot;duration_relationship_total&quot;, xsection) + scale_x_sqrt(breaks = c(1,5, 10, 20, 30))</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  duration_relationship_total by hormonal_contraception
## t = -7, df = 600, p-value = 8e-13
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.9 -1.7
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                       3.0                                       5.3 
## 
## 
## Hedges&#39;s g
## 
## g estimate: -0.38 (small)
## 95 percent confidence interval:
## lower upper 
## -0.51 -0.26</code></pre>
<pre><code>## Warning: Removed 5 rows containing non-finite values (stat_density).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="reported-cycle-length" class="section level3">
<h3>Reported cycle length</h3>
<pre class="r"><code>compare_by_group(&quot;cycle_length&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  cycle_length by hormonal_contraception
## t = -5, df = 800, p-value = 0.0000001
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.56 -0.72
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                        28                                        29 
## 
## 
## Hedges&#39;s g
## 
## g estimate: -0.31 (small)
## 95 percent confidence interval:
## lower upper 
## -0.43 -0.19</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="reported-cycle-regularity" class="section level3">
<h3>Reported cycle regularity</h3>
<pre class="r"><code>jmv::contTables(
    data = xsection,
    rows = c( &quot;cycle_regularity&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                                     
##  ────────────────────────────────────────────────────────────────────────────────────── 
##    cycle_regularity                                           0        1        Total   
##  ────────────────────────────────────────────────────────────────────────────────────── 
##    very regular,
## up to 2 days off          Observed             198      503      701   
##                                            % within column     46.2     80.5            
##                                                                                         
##    slightly irregular,
## up to 5 days off    Observed             142       73      215   
##                                            % within column     33.1     11.7            
##                                                                                         
##    irregular,
## more than 5 days off         Observed              89       49      138   
##                                            % within column     20.7      7.8            
##                                                                                         
##    Total                                   Observed             429      625     1054   
##                                            % within column    100.0    100.0            
##  ────────────────────────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²      135     2    &lt; .001   
##    N      1054                   
##  ───────────────────────────────</code></pre>
</div>
<div id="number-of-sexual-partners" class="section level3">
<h3>Number of sexual partners</h3>
<pre class="r"><code>compare_by_group(&quot;number_sexual_partner&quot;, xsection) + scale_x_sqrt(breaks = c(1,5, 10, 20, 50, 100))</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  number_sexual_partner by hormonal_contraception
## t = -5, df = 600, p-value = 0.000004
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -5.1 -2.1
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                       5.7                                       9.3 
## 
## 
## Hedges&#39;s g
## 
## g estimate: -0.24 (small)
## 95 percent confidence interval:
## lower upper 
## -0.36 -0.12</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="extraversion" class="section level3">
<h3>Extraversion</h3>
<pre class="r"><code>compare_by_group(&quot;BFI_extra&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  BFI_extra by hormonal_contraception
## t = -0.4, df = 900, p-value = 0.7
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.117  0.079
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                       3.5                                       3.5 
## 
## 
## Hedges&#39;s g
## 
## g estimate: -0.024 (negligible)
## 95 percent confidence interval:
##  lower  upper 
## -0.147  0.099</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="agreeableness" class="section level3">
<h3>Agreeableness</h3>
<pre class="r"><code>compare_by_group(&quot;BFI_agree&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  BFI_agree by hormonal_contraception
## t = -0.2, df = 900, p-value = 0.8
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.080  0.065
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                       3.6                                       3.6 
## 
## 
## Hedges&#39;s g
## 
## g estimate: -0.013 (negligible)
## 95 percent confidence interval:
## lower upper 
## -0.14  0.11</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="neuroticism" class="section level3">
<h3>Neuroticism</h3>
<pre class="r"><code>compare_by_group(&quot;BFI_neuro&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  BFI_neuro by hormonal_contraception
## t = 2, df = 900, p-value = 0.02
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.019 0.206
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                       3.1                                       3.0 
## 
## 
## Hedges&#39;s g
## 
## g estimate: 0.15 (negligible)
## 95 percent confidence interval:
## lower upper 
## 0.022 0.268</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="conscientiousness" class="section level3">
<h3>Conscientiousness</h3>
<pre class="r"><code>compare_by_group(&quot;BFI_consc&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  BFI_consc by hormonal_contraception
## t = 2, df = 900, p-value = 0.02
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.016 0.185
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                       3.6                                       3.5 
## 
## 
## Hedges&#39;s g
## 
## g estimate: 0.14 (negligible)
## 95 percent confidence interval:
## lower upper 
##  0.02  0.27</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="openness" class="section level3">
<h3>Openness</h3>
<pre class="r"><code>compare_by_group(&quot;BFI_open&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  BFI_open by hormonal_contraception
## t = -5, df = 900, p-value = 0.0000004
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.28 -0.12
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                       3.6                                       3.8 
## 
## 
## Hedges&#39;s g
## 
## g estimate: -0.32 (small)
## 95 percent confidence interval:
## lower upper 
## -0.45 -0.20</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="relationship-satisfaction" class="section level3">
<h3>Relationship satisfaction</h3>
<pre class="r"><code>compare_by_group(&quot;ZIP&quot;, xsection)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  ZIP by hormonal_contraception
## t = 3, df = 900, p-value = 0.002
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.049 0.227
## sample estimates:
## mean in group hormonal contraceptive user           mean in group naturally cycling 
##                                       4.2                                       4.0 
## 
## 
## Hedges&#39;s g
## 
## g estimate: 0.18 (negligible)
## 95 percent confidence interval:
## lower upper 
## 0.061 0.307</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="occupation" class="section level3">
<h3>Occupation</h3>
<pre class="r"><code>xsection$occupation_clean = factor(xsection$occupation_clean, c( &quot;Studentin&quot;,  &quot;Schülerin&quot;, &quot;Auszubildende&quot;, &quot;Berufstätig&quot;, &quot;Hausfrau&quot;, &quot;Nicht berufstätig&quot;))
jmv::contTables(
    data = xsection,
    rows = c( &quot;occupation_clean&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                  
##  ─────────────────────────────────────────────────────────────────── 
##    occupation_clean                        0        1        Total   
##  ─────────────────────────────────────────────────────────────────── 
##    Studentin            Observed             247      489      736   
##                         % within column     57.7     78.5            
##                                                                      
##    Schülerin            Observed               3       12       15   
##                         % within column      0.7      1.9            
##                                                                      
##    Auszubildende        Observed               4       10       14   
##                         % within column      0.9      1.6            
##                                                                      
##    Berufstätig          Observed             151      104      255   
##                         % within column     35.3     16.7            
##                                                                      
##    Hausfrau             Observed              14        6       20   
##                         % within column      3.3      1.0            
##                                                                      
##    Nicht berufstätig    Observed               9        2       11   
##                         % within column      2.1      0.3            
##                                                                      
##    Total                Observed             428      623     1051   
##                         % within column    100.0    100.0            
##  ─────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     70.1     5    &lt; .001   
##    N      1051                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, occupation_clean) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="religion" class="section level3">
<h3>Religion</h3>
<pre class="r"><code>jmv::contTables(
    data = xsection,
    rows = c( &quot;religion_clean&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                               
##  ──────────────────────────────────────────────────────────────── 
##    religion_clean                       0        1        Total   
##  ──────────────────────────────────────────────────────────────── 
##    Buddhismus        Observed               5        2        7   
##                      % within column      1.2      0.3            
##                                                                   
##    Christentum       Observed             217      366      583   
##                      % within column     50.7     58.7            
##                                                                   
##    Islam             Observed               8        7       15   
##                      % within column      1.9      1.1            
##                                                                   
##    Judentum          Observed               1        0        1   
##                      % within column      0.2      0.0            
##                                                                   
##    Nicht gläubig     Observed             197      249      446   
##                      % within column     46.0     39.9            
##                                                                   
##    Total             Observed             428      624     1052   
##                      % within column    100.0    100.0            
##  ──────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                       
##  ────────────────────────────── 
##          Value    df    p       
##  ────────────────────────────── 
##    χ²     10.3     4    0.035   
##    N      1052                  
##  ──────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, religion_clean) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="income" class="section level3">
<h3>Income</h3>
<pre class="r"><code>xsection$income = factor(xsection$income, c(&quot;&lt; 500€&quot;, &quot;500-1000€&quot;, &quot;1000-2000€&quot;, &quot;2000-3000€&quot;, &quot;&gt; 3000€&quot;))
jmv::contTables(
    data = xsection,
    rows = c( &quot;income&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                           
##  ──────────────────────────────────────────────────────────── 
##    income                           0        1        Total   
##  ──────────────────────────────────────────────────────────── 
##    &lt; 500€        Observed              38       65      103   
##                  % within column     16.5     27.3            
##                                                               
##    500-1000€     Observed              61       90      151   
##                  % within column     26.5     37.8            
##                                                               
##    1000-2000€    Observed              64       44      108   
##                  % within column     27.8     18.5            
##                                                               
##    2000-3000€    Observed              42       25       67   
##                  % within column     18.3     10.5            
##                                                               
##    &gt; 3000€       Observed              25       14       39   
##                  % within column     10.9      5.9            
##                                                               
##    Total         Observed             230      238      468   
##                  % within column    100.0    100.0            
##  ──────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     23.6     4    &lt; .001   
##    N       468                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, income) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="income-partner" class="section level3">
<h3>Income partner</h3>
<pre class="r"><code>xsection$income_partner = factor(xsection$income_partner, c(&quot;&lt; 500€&quot;, &quot;500-1000€&quot;, &quot;1000-2000€&quot;, &quot;2000-3000€&quot;, &quot;&gt; 3000€&quot;))
jmv::contTables(
    data = xsection,
    rows = c( &quot;income_partner&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                               
##  ──────────────────────────────────────────────────────────────── 
##    income_partner                       0        1        Total   
##  ──────────────────────────────────────────────────────────────── 
##    &lt; 500€            Observed              62      121      183   
##                      % within column     14.5     19.4            
##                                                                   
##    500-1000€         Observed             122      245      367   
##                      % within column     28.4     39.2            
##                                                                   
##    1000-2000€        Observed             101      141      242   
##                      % within column     23.5     22.6            
##                                                                   
##    2000-3000€        Observed              64       73      137   
##                      % within column     14.9     11.7            
##                                                                   
##    &gt; 3000€           Observed              80       45      125   
##                      % within column     18.6      7.2            
##                                                                   
##    Total             Observed             429      625     1054   
##                      % within column    100.0    100.0            
##  ──────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     42.3     4    &lt; .001   
##    N      1054                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, income_partner) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="relationship-status" class="section level3">
<h3>Relationship status</h3>
<pre class="r"><code>xsection$relationship_status_clean = factor(xsection$relationship_status_clean, levels = c(&quot;Partnerschaft&quot;, &quot;Verlobt&quot;, &quot;Verheiratet&quot;))
jmv::contTables(
    data = xsection,
    rows = c( &quot;relationship_status_clean&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                          
##  ─────────────────────────────────────────────────────────────────────────── 
##    relationship_status_clean                       0        1        Total   
##  ─────────────────────────────────────────────────────────────────────────── 
##    Partnerschaft                Observed             304      577      881   
##                                 % within column     70.9     92.3            
##                                                                              
##    Verlobt                      Observed              21       18       39   
##                                 % within column      4.9      2.9            
##                                                                              
##    Verheiratet                  Observed             104       30      134   
##                                 % within column     24.2      4.8            
##                                                                              
##    Total                        Observed             429      625     1054   
##                                 % within column    100.0    100.0            
##  ─────────────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     92.4     2    &lt; .001   
##    N      1054                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, relationship_status_clean) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="cohabitation" class="section level3">
<h3>Cohabitation</h3>
<pre class="r"><code>xsection$cohabitation = factor(xsection$cohabitation, c(&quot;Long-distance&quot;, &quot;Live in same city&quot;, &quot;Live in same apartment&quot;))
jmv::contTables(
    data = xsection,
    rows = c( &quot;cohabitation&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                       
##  ──────────────────────────────────────────────────────────────────────── 
##    cohabitation                                 0        1        Total   
##  ──────────────────────────────────────────────────────────────────────── 
##    Long-distance             Observed             107      221      328   
##                              % within column     24.9     35.4            
##                                                                           
##    Live in same city         Observed              89      206      295   
##                              % within column     20.7     33.0            
##                                                                           
##    Live in same apartment    Observed             233      198      431   
##                              % within column     54.3     31.7            
##                                                                           
##    Total                     Observed             429      625     1054   
##                              % within column    100.0    100.0            
##  ──────────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     54.3     2    &lt; .001   
##    N      1054                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, cohabitation) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code>jmv::contTables(
    data = xsection,
    rows = c( &quot;days_with_partner_per_month&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                            
##  ───────────────────────────────────────────────────────────────────────────── 
##    days_with_partner_per_month                       0        1        Total   
##  ───────────────────────────────────────────────────────────────────────────── 
##    &lt; 3 days                       Observed              20       20       40   
##                                   % within column     18.7      9.0            
##                                                                                
##    3-5 days                       Observed              14       28       42   
##                                   % within column     13.1     12.7            
##                                                                                
##    5-7 days                       Observed              41       78      119   
##                                   % within column     38.3     35.3            
##                                                                                
##    7-14 days                      Observed              30       84      114   
##                                   % within column     28.0     38.0            
##                                                                                
##    &gt; 14 days                      Observed               2       11       13   
##                                   % within column      1.9      5.0            
##                                                                                
##    Total                          Observed             107      221      328   
##                                   % within column    100.0    100.0            
##  ───────────────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                       
##  ────────────────────────────── 
##          Value    df    p       
##  ────────────────────────────── 
##    χ²     9.51     4    0.050   
##    N       328                  
##  ──────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, days_with_partner_per_month) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<pre class="r"><code>jmv::contTables(
    data = xsection,
    rows = c( &quot;days_with_partner&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                  
##  ─────────────────────────────────────────────────────────────────── 
##    days_with_partner                       0        1        Total   
##  ─────────────────────────────────────────────────────────────────── 
##    &lt; 3 days             Observed             118      201      319   
##                         % within column     27.5     32.2            
##                                                                      
##    3-5 days             Observed              95      213      308   
##                         % within column     22.1     34.1            
##                                                                      
##    7 days               Observed             216      211      427   
##                         % within column     50.3     33.8            
##                                                                      
##    Total                Observed             429      625     1054   
##                         % within column    100.0    100.0            
##  ─────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     31.5     2    &lt; .001   
##    N      1054                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, days_with_partner) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-26-3.png" width="672" /></p>
<pre class="r"><code>jmv::contTables(
    data = xsection,
    rows = c( &quot;nights_with_partner&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                    
##  ───────────────────────────────────────────────────────────────────── 
##    nights_with_partner                       0        1        Total   
##  ───────────────────────────────────────────────────────────────────── 
##    &lt; 3 nights             Observed             142      239      381   
##                           % within column     33.1     38.2            
##                                                                        
##    3-5 nights             Observed             101      191      292   
##                           % within column     23.5     30.6            
##                                                                        
##    7 nights               Observed             186      195      381   
##                           % within column     43.4     31.2            
##                                                                        
##    Total                  Observed             429      625     1054   
##                           % within column    100.0    100.0            
##  ───────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     16.8     2    &lt; .001   
##    N      1054                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, nights_with_partner) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-26-4.png" width="672" /></p>
</div>
<div id="living-situation" class="section level3">
<h3>Living situation</h3>
<pre class="r"><code>xsection$living_situation = factor(xsection$living_situation)
jmv::contTables(
    data = xsection,
    rows = c( &quot;living_situation&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                               
##  ──────────────────────────────────────────────────────────────────────────────── 
##    living_situation                                     0        1        Total   
##  ──────────────────────────────────────────────────────────────────────────────── 
##    living alone                      Observed              90      175      265   
##                                      % within column     21.0     28.0            
##                                                                                   
##    living in all-female flatshare    Observed              41      116      157   
##                                      % within column      9.6     18.6            
##                                                                                   
##    living in mixed-sex flatshare     Observed              65      136      201   
##                                      % within column     15.2     21.8            
##                                                                                   
##    living with partner               Observed             233      198      431   
##                                      % within column     54.3     31.7            
##                                                                                   
##    Total                             Observed             429      625     1054   
##                                      % within column    100.0    100.0            
##  ──────────────────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     56.5     3    &lt; .001   
##    N      1054                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, living_situation) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="children" class="section level3">
<h3>Children</h3>
<pre class="r"><code>xsection$children_broad_categories = factor(xsection$children_broad_categories, levels = c(&quot;no_children&quot;, &quot;children&quot;))

jmv::contTables(
    data = xsection,
    rows = c( &quot;children_narrow_categories&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                           
##  ──────────────────────────────────────────────────────────────────────────── 
##    children_narrow_categories                       0        1        Total   
##  ──────────────────────────────────────────────────────────────────────────── 
##    Biological children           Observed              83       27      110   
##                                  % within column     19.3      4.3            
##                                                                               
##    Complex family                Observed               7        3       10   
##                                  % within column      1.6      0.5            
##                                                                               
##    Foster children               Observed               0        1        1   
##                                  % within column      0.0      0.2            
##                                                                               
##    No children                   Observed             333      591      924   
##                                  % within column     77.6     94.6            
##                                                                               
##    Step children                 Observed               6        3        9   
##                                  % within column      1.4      0.5            
##                                                                               
##    Total                         Observed             429      625     1054   
##                                  % within column    100.0    100.0            
##  ──────────────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     70.1     4    &lt; .001   
##    N      1054                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, children_narrow_categories) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre class="r"><code>jmv::contTables(
    data = xsection,
    rows = c( &quot;children_broad_categories&quot;),
    cols = &quot;hormonal_contraception&quot;, pcCol = T)</code></pre>
<pre><code>## 
##  CONTINGENCY TABLES
## 
##  Contingency Tables                                                          
##  ─────────────────────────────────────────────────────────────────────────── 
##    children_broad_categories                       0        1        Total   
##  ─────────────────────────────────────────────────────────────────────────── 
##    no_children                  Observed             334      593      927   
##                                 % within column     77.9     94.9            
##                                                                              
##    children                     Observed              95       32      127   
##                                 % within column     22.1      5.1            
##                                                                              
##    Total                        Observed             429      625     1054   
##                                 % within column    100.0    100.0            
##  ─────────────────────────────────────────────────────────────────────────── 
## 
## 
##  χ² Tests                        
##  ─────────────────────────────── 
##          Value    df    p        
##  ─────────────────────────────── 
##    χ²     69.6     1    &lt; .001   
##    N      1054                   
##  ───────────────────────────────</code></pre>
<pre class="r"><code>bar_count(xsection, children_broad_categories) + hcfacet</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
</div>
<div id="comparison-summary" class="section level3">
<h3>Comparison summary</h3>
<div id="comparison-of-continuous-variables" class="section level4">
<h4>Comparison of continuous variables</h4>
<pre class="r"><code>pander(comps)</code></pre>
<table>
<colgroup>
<col width="31%" />
<col width="22%" />
<col width="22%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">var</th>
<th align="center">HC user - Mean (SD)</th>
<th align="center">Cycling - Mean (SD)</th>
<th align="center">hedges_g</th>
<th align="center">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">age</td>
<td align="center">23.7 (4.7)</td>
<td align="center">28.9 (8.4)</td>
<td align="center">-0.61</td>
<td align="center">&lt; .001</td>
</tr>
<tr class="even">
<td align="center">religiosity</td>
<td align="center">2.0 (1.1)</td>
<td align="center">2.0 (1.2)</td>
<td align="center">-0.01</td>
<td align="center">= .931</td>
</tr>
<tr class="odd">
<td align="center">first_time</td>
<td align="center">16.9 (2.3)</td>
<td align="center">16.9 (2.4)</td>
<td align="center">0.00</td>
<td align="center">= .977</td>
</tr>
<tr class="even">
<td align="center">menarche</td>
<td align="center">13.1 (1.3)</td>
<td align="center">13.0 (1.5)</td>
<td align="center">0.06</td>
<td align="center">= .476</td>
</tr>
<tr class="odd">
<td align="center">duration_relationship_total</td>
<td align="center">3.0 (3.0)</td>
<td align="center">5.3 (5.9)</td>
<td align="center">-0.38</td>
<td align="center">&lt; .001</td>
</tr>
<tr class="even">
<td align="center">cycle_length</td>
<td align="center">28.0 (3.0)</td>
<td align="center">29.1 (3.7)</td>
<td align="center">-0.31</td>
<td align="center">&lt; .001</td>
</tr>
<tr class="odd">
<td align="center">number_sexual_partner</td>
<td align="center">5.7 (7.2)</td>
<td align="center">9.3 (14.9)</td>
<td align="center">-0.24</td>
<td align="center">&lt; .001</td>
</tr>
<tr class="even">
<td align="center">BFI_extra</td>
<td align="center">3.5 (0.8)</td>
<td align="center">3.5 (0.8)</td>
<td align="center">-0.02</td>
<td align="center">= .703</td>
</tr>
<tr class="odd">
<td align="center">BFI_agree</td>
<td align="center">3.6 (0.6)</td>
<td align="center">3.6 (0.6)</td>
<td align="center">-0.01</td>
<td align="center">= .840</td>
</tr>
<tr class="even">
<td align="center">BFI_neuro</td>
<td align="center">3.1 (0.7)</td>
<td align="center">3.0 (0.8)</td>
<td align="center">0.15</td>
<td align="center">= .018</td>
</tr>
<tr class="odd">
<td align="center">BFI_consc</td>
<td align="center">3.6 (0.7)</td>
<td align="center">3.5 (0.7)</td>
<td align="center">0.14</td>
<td align="center">= .019</td>
</tr>
<tr class="even">
<td align="center">BFI_open</td>
<td align="center">3.6 (0.6)</td>
<td align="center">3.8 (0.6)</td>
<td align="center">-0.32</td>
<td align="center">&lt; .001</td>
</tr>
<tr class="odd">
<td align="center">ZIP</td>
<td align="center">4.2 (0.7)</td>
<td align="center">4.0 (0.7)</td>
<td align="center">0.18</td>
<td align="center">= .002</td>
</tr>
</tbody>
</table>
</div>
<div id="categorical-regression-with-many-predictors-at-once" class="section level4">
<h4>Categorical regression with many predictors at once</h4>
<pre class="r"><code>altogether = glm(hormonal_contraception ~ age + cohabitation + living_situation + religiosity + ZIP + BFI_extra + BFI_neuro + BFI_agree + BFI_consc + BFI_open + first_time + duration_relationship_years + log1p(number_sexual_partner) + children_broad_categories + relationship_status_clean  + occupation_clean + income_partner, data = xsection, family = binomial(&quot;probit&quot;))
summary(altogether)</code></pre>
<pre><code>## 
## Call:
## glm(formula = hormonal_contraception ~ age + cohabitation + living_situation + 
##     religiosity + ZIP + BFI_extra + BFI_neuro + BFI_agree + BFI_consc + 
##     BFI_open + first_time + duration_relationship_years + log1p(number_sexual_partner) + 
##     children_broad_categories + relationship_status_clean + occupation_clean + 
##     income_partner, family = binomial(&quot;probit&quot;), data = xsection)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -2.435  -1.007   0.579   0.855   2.507  
## 
## Coefficients: (1 not defined because of singularities)
##                                                Estimate Std. Error z value   Pr(&gt;|z|)    
## (Intercept)                                     1.44379    0.74119    1.95    0.05142 .  
## age                                            -0.06476    0.01426   -4.54 0.00000561 ***
## cohabitationLive in same city                   0.15748    0.11704    1.35    0.17847    
## cohabitationLive in same apartment             -0.20454    0.13146   -1.56    0.11973    
## living_situationliving in all-female flatshare  0.07042    0.15019    0.47    0.63917    
## living_situationliving in mixed-sex flatshare  -0.12374    0.13620   -0.91    0.36361    
## living_situationliving with partner                  NA         NA      NA         NA    
## religiosity                                     0.02176    0.04203    0.52    0.60463    
## ZIP                                             0.16403    0.06273    2.61    0.00893 ** 
## BFI_extra                                       0.03132    0.06196    0.51    0.61324    
## BFI_neuro                                       0.09406    0.06627    1.42    0.15584    
## BFI_agree                                      -0.02284    0.08065   -0.28    0.77702    
## BFI_consc                                       0.23409    0.06960    3.36    0.00077 ***
## BFI_open                                       -0.37380    0.07335   -5.10 0.00000035 ***
## first_time                                      0.00873    0.02236    0.39    0.69603    
## duration_relationship_years                     0.01766    0.01733    1.02    0.30828    
## log1p(number_sexual_partner)                   -0.07085    0.07860   -0.90    0.36739    
## children_broad_categorieschildren              -0.06439    0.17741   -0.36    0.71665    
## relationship_status_cleanVerlobt               -0.15917    0.23852   -0.67    0.50457    
## relationship_status_cleanVerheiratet           -0.59552    0.18578   -3.21    0.00135 ** 
## occupation_cleanSchülerin                       0.52941    0.45055    1.18    0.23999    
## occupation_cleanAuszubildende                   0.32267    0.40049    0.81    0.42042    
## occupation_cleanBerufstätig                     0.05580    0.13338    0.42    0.67567    
## occupation_cleanHausfrau                        0.17117    0.36395    0.47    0.63813    
## occupation_cleanNicht berufstätig              -0.96638    0.50030   -1.93    0.05341 .  
## income_partner500-1000€                         0.09692    0.13262    0.73    0.46487    
## income_partner1000-2000€                        0.07921    0.14379    0.55    0.58171    
## income_partner2000-3000€                        0.05934    0.16989    0.35    0.72687    
## income_partner&gt; 3000€                           0.19883    0.19986    0.99    0.31982    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1365.8  on 1016  degrees of freedom
## Residual deviance: 1122.2  on  989  degrees of freedom
##   (37 observations deleted due to missingness)
## AIC: 1178
## 
## Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="categorical-regression-limited-to-lax-subset" class="section level4">
<h4>Categorical regression limited to lax subset</h4>
<pre class="r"><code>altogether = glm(hormonal_contraception ~ age + cohabitation + living_situation + religiosity + ZIP + BFI_extra + BFI_neuro + BFI_agree + BFI_consc + BFI_open + first_time + duration_relationship_years + log1p(number_sexual_partner) + children_broad_categories + relationship_status_clean  + occupation_clean + income_partner, data = xsection %&gt;% filter(!is.na(included_lax)), family = binomial(&quot;probit&quot;))
summary(altogether)</code></pre>
<pre><code>## 
## Call:
## glm(formula = hormonal_contraception ~ age + cohabitation + living_situation + 
##     religiosity + ZIP + BFI_extra + BFI_neuro + BFI_agree + BFI_consc + 
##     BFI_open + first_time + duration_relationship_years + log1p(number_sexual_partner) + 
##     children_broad_categories + relationship_status_clean + occupation_clean + 
##     income_partner, family = binomial(&quot;probit&quot;), data = xsection %&gt;% 
##     filter(!is.na(included_lax)))
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -2.374  -0.640   0.512   0.751   1.658  
## 
## Coefficients: (1 not defined because of singularities)
##                                                 Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)                                      2.67698    1.21001    2.21   0.0269 * 
## age                                             -0.04113    0.02777   -1.48   0.1386   
## cohabitationLive in same city                    0.23039    0.17782    1.30   0.1951   
## cohabitationLive in same apartment              -0.31849    0.21603   -1.47   0.1404   
## living_situationliving in all-female flatshare  -0.03763    0.23561   -0.16   0.8731   
## living_situationliving in mixed-sex flatshare   -0.30461    0.20124   -1.51   0.1301   
## living_situationliving with partner                   NA         NA      NA       NA   
## religiosity                                      0.05996    0.06547    0.92   0.3597   
## ZIP                                              0.05308    0.11036    0.48   0.6305   
## BFI_extra                                       -0.09321    0.09820   -0.95   0.3425   
## BFI_neuro                                       -0.01510    0.10506   -0.14   0.8857   
## BFI_agree                                       -0.04111    0.12686   -0.32   0.7459   
## BFI_consc                                        0.25412    0.11110    2.29   0.0222 * 
## BFI_open                                        -0.34491    0.10984   -3.14   0.0017 **
## first_time                                      -0.00127    0.03490   -0.04   0.9709   
## duration_relationship_years                     -0.01880    0.02902   -0.65   0.5171   
## log1p(number_sexual_partner)                    -0.17006    0.12527   -1.36   0.1746   
## children_broad_categorieschildren               -0.07860    0.31329   -0.25   0.8019   
## relationship_status_cleanVerlobt                -0.25265    0.39302   -0.64   0.5203   
## relationship_status_cleanVerheiratet            -0.27336    0.32458   -0.84   0.3997   
## occupation_cleanSchülerin                        4.57837  135.22482    0.03   0.9730   
## occupation_cleanAuszubildende                   -0.13051    0.61475   -0.21   0.8319   
## occupation_cleanBerufstätig                     -0.17331    0.21402   -0.81   0.4181   
## occupation_cleanHausfrau                         0.10827    0.95176    0.11   0.9094   
## occupation_cleanNicht berufstätig               -0.44499    0.69345   -0.64   0.5211   
## income_partner500-1000€                          0.19814    0.19447    1.02   0.3083   
## income_partner1000-2000€                         0.04447    0.21683    0.21   0.8375   
## income_partner2000-3000€                         0.02285    0.27543    0.08   0.9339   
## income_partner&gt; 3000€                            0.17485    0.32482    0.54   0.5904   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 565.86  on 494  degrees of freedom
## Residual deviance: 477.26  on 467  degrees of freedom
##   (22 observations deleted due to missingness)
## AIC: 533.3
## 
## Number of Fisher Scoring iterations: 14</code></pre>
<div id="restricted-to-predictors-significant-in-the-whole-sample" class="section level5">
<h5>Restricted to predictors significant in the whole sample</h5>
<pre class="r"><code>fewer_preds = glm(hormonal_contraception ~ age + cohabitation + + ZIP + BFI_consc + BFI_open + relationship_status_clean, data = xsection %&gt;% filter(!is.na(included_lax)), family = binomial(&quot;probit&quot;))
summary(fewer_preds)</code></pre>
<pre><code>## 
## Call:
## glm(formula = hormonal_contraception ~ age + cohabitation + +ZIP + 
##     BFI_consc + BFI_open + relationship_status_clean, family = binomial(&quot;probit&quot;), 
##     data = xsection %&gt;% filter(!is.na(included_lax)))
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -2.326  -0.906   0.575   0.758   2.066  
## 
## Coefficients:
##                                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                            2.5342     0.6909    3.67  0.00024 ***
## age                                   -0.0587     0.0166   -3.53  0.00041 ***
## cohabitationLive in same city          0.0511     0.1580    0.32  0.74649    
## cohabitationLive in same apartment    -0.2522     0.1643   -1.53  0.12494    
## ZIP                                    0.0433     0.1001    0.43  0.66576    
## BFI_consc                              0.2109     0.0953    2.21  0.02701 *  
## BFI_open                              -0.3591     0.0983   -3.65  0.00026 ***
## relationship_status_cleanVerlobt      -0.6205     0.3314   -1.87  0.06115 .  
## relationship_status_cleanVerheiratet  -0.2598     0.2702   -0.96  0.33614    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 609.76  on 516  degrees of freedom
## Residual deviance: 542.03  on 508  degrees of freedom
## AIC: 560
## 
## Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</div>
</div>
<div id="further-plots" class="section level2">
<h2>Further plots</h2>
<pre class="r"><code>bar_count(xsection, has_not_had_sex_yet)</code></pre>
<p><img src="2_descriptives_files/figure-html/demographic%20data-1.png" width="672" /></p>
<pre class="r"><code>bar_count(xsection, had_sex_with_partner_yet)</code></pre>
<p><img src="2_descriptives_files/figure-html/demographic%20data-2.png" width="672" /></p>
<pre class="r"><code>bar_count(xsection, trying_to_get_pregnant)</code></pre>
<p><img src="2_descriptives_files/figure-html/demographic%20data-3.png" width="672" /></p>
<pre class="r"><code>bar_count(xsection, breast_feeding_in_last_3_months)</code></pre>
<p><img src="2_descriptives_files/figure-html/demographic%20data-4.png" width="672" /></p>
<pre class="r"><code>bar_count(xsection, pregnant_in_last_3_months)</code></pre>
<p><img src="2_descriptives_files/figure-html/demographic%20data-5.png" width="672" /></p>
<pre class="r"><code>bar_count(xsection, hormonal_medication_in_last_3_months)</code></pre>
<p><img src="2_descriptives_files/figure-html/demographic%20data-6.png" width="672" /></p>
<pre class="r"><code>bar_count(xsection, pill_in_last_3_months)</code></pre>
<p><img src="2_descriptives_files/figure-html/demographic%20data-7.png" width="672" /></p>
</div>
<div id="predictors" class="section level2 tab-content">
<h2>Predictors</h2>
<div id="sample-sizes" class="section level3">
<h3>Sample sizes</h3>
<p>Comparing the various predictors</p>
<pre class="r"><code>diary %&gt;% select(person, day_number, fertile_narrow, fertile_broad, fertile_narrow_forward_counted, fertile_broad_forward_counted, prc_stirn_b_squished, prc_stirn_b_backward_inferred) %&gt;% 
  gather(predictor, value, -person) %&gt;% 
  mutate(description = recode(predictor, &quot;day_number&quot; = &#39;&#39;, 
  &quot;fertile_narrow&quot; = &#39;narrow window, backward counted&#39;, 
  &quot;fertile_broad&quot; = &#39;broad window, backward counted&#39;, 
  &quot;fertile_narrow_forward_counted&quot; = &#39;narrow window, forward counted&#39;, 
  &quot;fertile_broad_forward_counted&quot; = &#39;broad window, forward counted&#39;, 
  &quot;prc_stirn_b_squished&quot; = &#39;continuous, backward counted&#39;, 
  &quot;prc_stirn_b_backward_inferred&quot; = &#39;continuous, backward counted from reported cycle length&#39;),
  predictor = factor(recode(predictor, &quot;day_number&quot; = &#39;all days&#39;, 
  &quot;fertile_narrow&quot; = &#39;narrow BC&#39;, 
  &quot;fertile_broad&quot; = &#39;broad BC&#39;, 
  &quot;fertile_narrow_forward_counted&quot; = &#39;narrow FC&#39;, 
  &quot;fertile_broad_forward_counted&quot; = &#39;broad FC&#39;, 
  &quot;prc_stirn_b_squished&quot; = &#39;cont. BC&#39;, 
  &quot;prc_stirn_b_backward_inferred&quot; = &#39;continuous BCi&#39;), levels = 
    c(&quot;all days&quot;, &quot;narrow BC&quot;, &quot;broad BC&quot;, &quot;narrow FC&quot;, &quot;broad FC&quot;, 
&quot;cont. BC&quot;, &quot;continuous BCi&quot;))) %&gt;% 
  group_by(predictor, description) %&gt;% 
  summarise(`n (days)` = n_nonmissing(value), 
            `% of days` = form(n_nonmissing(value)/n()*100), 
            `n (women)` = n_distinct(person[!is.na(value)])) %&gt;% 
  data.frame(check.names = F) %&gt;% 
  pander()</code></pre>
<table>
<colgroup>
<col width="20%" />
<col width="38%" />
<col width="12%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">predictor</th>
<th align="center">description</th>
<th align="center">n (days)</th>
<th align="center">% of days</th>
<th align="center">n (women)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">all days</td>
<td align="center"></td>
<td align="center">28729</td>
<td align="center">100.00</td>
<td align="center">1054</td>
</tr>
<tr class="even">
<td align="center">narrow BC</td>
<td align="center">narrow window, backward counted</td>
<td align="center">9517</td>
<td align="center">33.13</td>
<td align="center">796</td>
</tr>
<tr class="odd">
<td align="center">broad BC</td>
<td align="center">broad window, backward counted</td>
<td align="center">11518</td>
<td align="center">40.09</td>
<td align="center">798</td>
</tr>
<tr class="even">
<td align="center">narrow FC</td>
<td align="center">narrow window, forward counted</td>
<td align="center">12219</td>
<td align="center">42.53</td>
<td align="center">978</td>
</tr>
<tr class="odd">
<td align="center">broad FC</td>
<td align="center">broad window, forward counted</td>
<td align="center">15940</td>
<td align="center">55.48</td>
<td align="center">1003</td>
</tr>
<tr class="even">
<td align="center">cont. BC</td>
<td align="center">continuous, backward counted</td>
<td align="center">17685</td>
<td align="center">61.56</td>
<td align="center">819</td>
</tr>
<tr class="odd">
<td align="center">continuous BCi</td>
<td align="center">continuous, backward counted from reported cycle length</td>
<td align="center">26702</td>
<td align="center">92.94</td>
<td align="center">1054</td>
</tr>
</tbody>
</table>
<pre class="r"><code>pander(missingness_patterns(diary %&gt;% ungroup %&gt;% select(prc_stirn_b, prc_stirn_b_forward_counted, prc_stirn_b_backward_inferred)))</code></pre>
<p>index col missings 1 prc_stirn_b 11078 2 prc_stirn_b_backward_inferred 2027 3 prc_stirn_b_forward_counted 1898</p>
<table style="width:67%;">
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="41%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Pattern</th>
<th align="center">Freq</th>
<th align="center">Culprit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">_____</td>
<td align="center">16579</td>
<td align="center">_</td>
</tr>
<tr class="even">
<td align="center">1____</td>
<td align="center">9051</td>
<td align="center">prc_stirn_b</td>
</tr>
<tr class="odd">
<td align="center">1_2__</td>
<td align="center">1201</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">____3</td>
<td align="center">1072</td>
<td align="center">prc_stirn_b_forward_counted</td>
</tr>
<tr class="odd">
<td align="center">1_2_3</td>
<td align="center">826</td>
<td align="center"></td>
</tr>
</tbody>
</table>
</div>
<div id="correlations" class="section level3">
<h3>Correlations</h3>
<pre class="r"><code>diary %&gt;% select(prc_stirn_b_squished, prc_stirn_b_forward_counted) %&gt;% 
cor(use=&#39;pairwise.complete.obs&#39;) %&gt;% form() %&gt;% pander()</code></pre>
<table>
<colgroup>
<col width="39%" />
<col width="26%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">prc_stirn_b_squished</th>
<th align="center">prc_stirn_b_forward_counted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>prc_stirn_b_squished</strong></td>
<td align="center">1.00</td>
<td align="center">0.67</td>
</tr>
<tr class="even">
<td align="center"><strong>prc_stirn_b_forward_counted</strong></td>
<td align="center">0.67</td>
<td align="center">1.00</td>
</tr>
</tbody>
</table>
</div>
<div id="plotted-menstruation-and-fertility-estimates" class="section level3 tab-content">
<h3>Plotted menstruation and fertility estimates</h3>
<pre class="r"><code>wall = list(scale_y_discrete(&quot;Person&quot;),
  geom_tile(), 
  scale_x_continuous(&quot;Relative to last observed menstrual onset&quot;, limits= c(-40, 15), breaks = seq(-40,15, by = 5)),
  geom_point(aes(colour=menstruation_strength)),
  scale_fill_distiller(&quot;Fertile window probability&quot;),
  scale_color_manual(&quot;Menstruation strength&quot;, values = c(&quot;0&quot;=&quot;transparent&quot;,&quot;1&quot;=&quot;pink&quot;,&quot;2&quot;=&quot;red&quot;,&quot;3&quot;=&quot;darkred&quot;)),
  geom_vline(aes(xintercept = limits, linetype = Window),data = data.frame(limits= c(-14.5,-19.5, -13.5,-22.5,-3.5,-12.5), Window = rep(c(&quot;narrow&quot;,&quot;broad&quot;,&quot;infertile&quot;),each=2)),color = &#39;black&#39;, size = 0.9, alpha = 0.9,show.legend = T),
  scale_linetype_manual(&quot;Window&quot;, values = c(&quot;narrow&quot;=&quot;solid&quot;,&quot;broad&quot;=&quot;dashed&quot;,&quot;infertile&quot;=&quot;dotted&quot;))
)</code></pre>
<div id="predictor-backward-counted" class="section level4">
<h4>Predictor: Backward-counted</h4>
<div id="cycling" class="section level5">
<h5>Cycling</h5>
<pre class="r"><code>diary %&gt;% filter(included_all == &quot;cycling&quot;,fertile_days_known_backward &gt; 10, sufficient_diary_coverage==T, ever_menstruated == T, any_RCD == T, person &lt; 400) %&gt;%
  ggplot(aes(x = RCD, y = factor(person), fill = prc_stirn_b)) + wall </code></pre>
<pre><code>## Warning: Removed 668 rows containing missing values (geom_tile).</code></pre>
<pre><code>## Warning: Removed 668 rows containing missing values (geom_point).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-36-1.png" width="960" /></p>
</div>
<div id="hormonally-contracepting" class="section level5">
<h5>Hormonally contracepting</h5>
<pre class="r"><code>diary %&gt;% filter(included_all == &quot;horm_contra&quot;,fertile_days_known_backward &gt; 10, sufficient_diary_coverage==T, ever_menstruated == T, any_RCD == T, person &lt; 400) %&gt;%
  ggplot(aes(x = RCD, y = factor(person), fill = prc_stirn_b)) + wall </code></pre>
<pre><code>## Warning: Removed 1411 rows containing missing values (geom_tile).</code></pre>
<pre><code>## Warning: Removed 1411 rows containing missing values (geom_point).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-37-1.png" width="960" /></p>
<p>####Predictor: Forward-counted ##### Cycling</p>
<pre class="r"><code>diary %&gt;% filter(included_all == &quot;cycling&quot;,fertile_days_known_backward &gt; 10, sufficient_diary_coverage==T, ever_menstruated == T, any_RCD == T, person &lt; 400) %&gt;%
  ggplot(aes(x = RCD, y = factor(person), fill = prc_stirn_b_forward_counted)) + wall </code></pre>
<pre><code>## Warning: Removed 668 rows containing missing values (geom_tile).</code></pre>
<pre><code>## Warning: Removed 668 rows containing missing values (geom_point).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-38-1.png" width="960" /></p>
</div>
<div id="hormonally-contracepting-1" class="section level5">
<h5>Hormonally contracepting</h5>
<pre class="r"><code>diary %&gt;% filter(included_all == &quot;horm_contra&quot;,fertile_days_known_backward &gt; 10, sufficient_diary_coverage==T, ever_menstruated == T, any_RCD == T, person &lt; 400) %&gt;%
  ggplot(aes(x = RCD, y = factor(person), fill = prc_stirn_b_forward_counted)) + wall </code></pre>
<pre><code>## Warning: Removed 1411 rows containing missing values (geom_tile).</code></pre>
<pre><code>## Warning: Removed 1411 rows containing missing values (geom_point).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-39-1.png" width="960" /></p>
</div>
</div>
<div id="predictor-forward-and-backward-averaged" class="section level4">
<h4>Predictor: Forward and backward averaged</h4>
<div id="cycling-1" class="section level5">
<h5>Cycling</h5>
<pre class="r"><code>diary %&gt;% filter(included_all == &quot;cycling&quot;,fertile_days_known_backward &gt; 10, sufficient_diary_coverage==T, ever_menstruated == T, any_RCD == T, person &lt; 400) %&gt;%
  ggplot(aes(x = RCD, y = factor(person), fill = fertile_forward_and_backward)) + wall </code></pre>
<pre><code>## Warning: Removed 668 rows containing missing values (geom_tile).</code></pre>
<pre><code>## Warning: Removed 668 rows containing missing values (geom_point).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-40-1.png" width="960" /></p>
</div>
<div id="hormonally-contracepting-2" class="section level5">
<h5>Hormonally contracepting</h5>
<pre class="r"><code>diary %&gt;% filter(included_all == &quot;horm_contra&quot;,fertile_days_known_backward &gt; 10, sufficient_diary_coverage==T, ever_menstruated == T, any_RCD == T, person &lt; 400) %&gt;%
  ggplot(aes(x = RCD, y = factor(person), fill = fertile_forward_and_backward)) + wall </code></pre>
<pre><code>## Warning: Removed 1411 rows containing missing values (geom_tile).</code></pre>
<pre><code>## Warning: Removed 1411 rows containing missing values (geom_point).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-41-1.png" width="960" /></p>
</div>
</div>
</div>
</div>
<div id="diary-generalizability" class="section level2 tab-content">
<h2>Diary generalizability</h2>
<pre class="r"><code>multi_rel = function(x, lme = T, lmer = T) { 
  mrel = x %&gt;%
  filter(day_number &lt;= 40) %&gt;%
  gather(variable, value, -person, -day_number) %&gt;%
  multilevel.reliability(., &quot;person&quot;, &quot;day_number&quot;, lme = lme, lmer = lmer, items = &quot;variable&quot;, values = &quot;value&quot;, long = T, aov = F)
  mrel
}</code></pre>
<div id="extra-pair-desire-and-behaviour" class="section level3">
<h3>Extra-pair desire and behaviour</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, extra_pair_2:extra_pair_13) %&gt;%
  multi_rel(lmer = T, lme = F)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with
## max|grad| = 0.0021235 (tol = 0.002, component 1)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  12 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.99 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.5 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.98 Generalizability of average time points across all items (Random time effects)
Rc   =  0.76 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.98 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.6 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.28    0.12
Time             0.00    0.00
Items            0.21    0.09
ID x time        0.24    0.10
ID x items       0.40    0.17
time x items     0.28    0.12
Residual         0.90    0.39
Total            2.31    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.32   0.157
id(time)     0.19   0.093
residual     1.51   0.750
total        2.01   1.000

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="extra-pair-desire" class="section level3">
<h3>Extra-pair desire</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, extra_pair_7, extra_pair_10, extra_pair_11, extra_pair_12, extra_pair_13) %&gt;%
  multi_rel(lmer = T, lme = F)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with
## max|grad| = 0.0145761 (tol = 0.002, component 1)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  5 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.99 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.55 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.98 Generalizability of average time points across all items (Random time effects)
Rc   =  0.62 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.98 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.36 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.37    0.17
Time             0.00    0.00
Items            0.14    0.07
ID x time        0.22    0.11
ID x items       0.32    0.15
time x items     0.37    0.17
Residual         0.68    0.32
Total            2.09    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.43   0.253
id(time)     0.13   0.076
residual     1.14   0.670
total        1.70   1.000

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="extra-pair-flirting" class="section level3">
<h3>Extra-pair flirting</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, extra_pair_4, extra_pair_8, extra_pair_9) %&gt;%
  multi_rel(lmer = T, lme = F)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with
## max|grad| = 0.00281509 (tol = 0.002, component 1)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  3 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.99 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.46 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.97 Generalizability of average time points across all items (Random time effects)
Rc   =  0.49 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.97 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.36 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.21    0.19
Time             0.00    0.00
Items            0.01    0.01
ID x time        0.14    0.12
ID x items       0.11    0.10
time x items     0.21    0.19
Residual         0.44    0.39
Total            1.10    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.24    0.27
id(time)     0.10    0.11
residual     0.54    0.61
total        0.89    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="extra-pair-compliments" class="section level3">
<h3>Extra-pair compliments</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, extra_pair_2, extra_pair_3) %&gt;%
  multi_rel(lmer = T, lme = F)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with
## max|grad| = 0.0619795 (tol = 0.002, component 1)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  2 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.99 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.44 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.97 Generalizability of average time points across all items (Random time effects)
Rc   =  0.54 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.97 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.24 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.58    0.02
Time             0.00    0.00
Items           34.54    0.92
ID x time        0.54    0.01
ID x items       0.39    0.01
time x items     0.58    0.02
Residual         0.93    0.02
Total           37.56    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.78   0.305
id(time)     0.24   0.093
residual     1.54   0.602
total        2.55   1.000

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="extra-pair-going-out" class="section level3">
<h3>Extra-pair going out</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, extra_pair_5, extra_pair_6) %&gt;%
  multi_rel(lmer = T, lme = F)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## singular fit</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  2 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.98 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.28 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.94 Generalizability of average time points across all items (Random time effects)
Rc   =  0.75 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.94 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.61 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.46    0.13
Time             0.00    0.00
Items            0.05    0.01
ID x time        1.35    0.36
ID x items       0.46    0.12
time x items     0.46    0.13
Residual         0.92    0.25
Total            3.69    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.69    0.21
id(time)     1.10    0.34
residual     1.42    0.44
total        3.21    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="extra-pair-sexual-fantasies" class="section level3">
<h3>Extra-pair sexual fantasies</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, extra_pair_13) %&gt;%
  multi_rel(lmer = F, lme = T)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  1 items.

 Alternative estimates of reliability based upon Generalizability theory

RkRn =  0.97 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.85 Generalizability of within person variations averaged over items  (time nested within people)
 The nested components of variance estimated from lme are:
         Variance Percent
id           0.67   0.453
id(time)     0.69   0.466
residual     0.12   0.081
total        1.48   1.000

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="in-pair-desire" class="section level3">
<h3>In-pair desire</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, sexual_intercourse_1_6scale, desirability_partner, attention_2) %&gt;%
  multi_rel(lme = F, lmer = T)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  3 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.99 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.38 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.96 Generalizability of average time points across all items (Random time effects)
Rc   =  0.82 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.96 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.75 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.68    0.21
Time             0.00    0.00
Items            0.09    0.03
ID x time        0.97    0.30
ID x items       0.17    0.05
time x items     0.68    0.21
Residual         0.62    0.19
Total            3.22    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.74    0.29
id(time)     0.89    0.35
residual     0.88    0.35
total        2.51    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="self-perceived-desirability" class="section level3">
<h3>Self-perceived desirability</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, desirability_1) %&gt;%
  multi_rel(lme = T, lmer = F)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  1 items.

 Alternative estimates of reliability based upon Generalizability theory

RkRn =  0.96 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.86 Generalizability of within person variations averaged over items  (time nested within people)
 The nested components of variance estimated from lme are:
         Variance Percent
id           0.72   0.364
id(time)     1.08   0.545
residual     0.18   0.091
total        1.98   1.000

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="sexy-clothing-choices" class="section level3">
<h3>Sexy clothing choices</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, matches(&quot;choice_of_clothing_(4|6|7)&quot;)) %&gt;%
  multi_rel(lmer = T)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with
## max|grad| = 0.122512 (tol = 0.002, component 1)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  3 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.99 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.39 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.96 Generalizability of average time points across all items (Random time effects)
Rc   =  0.81 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.96 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.6 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.52    0.18
Time             0.00    0.00
Items            0.35    0.12
ID x time        0.72    0.26
ID x items       0.18    0.07
time x items     0.52    0.18
Residual         0.52    0.18
Total            2.82    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.58    0.26
id(time)     0.54    0.24
residual     1.09    0.49
total        2.21    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="partner-mate-retention" class="section level3">
<h3>Partner mate retention</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, male_jealousy_2, male_mate_retention_1, male_mate_retention_2, male_attention_1) %&gt;%
  multi_rel(lme = F, lmer = T)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with
## max|grad| = 0.500119 (tol = 0.002, component 1)</code></pre>
<pre><code>## singular fit</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  4 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.98 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.46 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.97 Generalizability of average time points across all items (Random time effects)
Rc   =  0.43 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.96 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.30    0.07
Time             0.00    0.00
Items            1.04    0.24
ID x time        0.27    0.06
ID x items       0.97    0.22
time x items     0.30    0.07
Residual         1.44    0.33
Total            4.33    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.53    0.13
id(time)     0.00    0.00
residual     3.50    0.87
total        4.03    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="female-mate-retention" class="section level3">
<h3>Female mate retention</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, mate_retention_3, mate_retention_4, mate_retention_5, mate_retention_6, attention_1) %&gt;%
  multi_rel(lme = F, lmer = T)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with
## max|grad| = 0.0101463 (tol = 0.002, component 1)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  5 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.99 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.44 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.97 Generalizability of average time points across all items (Random time effects)
Rc   =  0.68 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.97 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.17 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.41    0.10
Time             0.00    0.00
Items            1.08    0.26
ID x time        0.48    0.11
ID x items       0.67    0.16
time x items     0.41    0.10
Residual         1.13    0.27
Total            4.18    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.54   0.152
id(time)     0.12   0.033
residual     2.93   0.816
total        3.59   1.000

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="female-jealousy" class="section level3">
<h3>Female jealousy</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, jealousy_1, male_jealousy_1, male_jealousy_3) %&gt;%
  multi_rel(lme = F, lmer = T)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with
## max|grad| = 0.00404246 (tol = 0.002, component 1)</code></pre>
<pre><code>## singular fit</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  3 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.98 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.42 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.97 Generalizability of average time points across all items (Random time effects)
Rc   =  0.29 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.96 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.12    0.06
Time             0.00    0.00
Items            0.45    0.21
ID x time        0.12    0.05
ID x items       0.49    0.23
time x items     0.12    0.06
Residual         0.85    0.40
Total            2.16    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.28    0.15
id(time)     0.00    0.00
residual     1.61    0.85
total        1.89    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="narcissistic-admiration" class="section level3">
<h3>Narcissistic admiration</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, NARQ_admiration_1, NARQ_admiration_2, NARQ_admiration_3) %&gt;%
  multi_rel(lmer = T, lme = F)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## singular fit</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  3 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  1 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.68 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.99 Generalizability of average time points across all items (Random time effects)
Rc   =  0.72 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.99 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.57 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               1.05    0.33
Time             0.00    0.00
Items            0.00    0.00
ID x time        0.38    0.12
ID x items       0.24    0.08
time x items     1.05    0.33
Residual         0.45    0.14
Total            3.17    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           1.13    0.53
id(time)     0.30    0.14
residual     0.69    0.33
total        2.12    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="narcissistic-rivalry" class="section level3">
<h3>Narcissistic rivalry</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, NARQ_rivalry_1, NARQ_rivalry_2, NARQ_rivalry_3) %&gt;%
  multi_rel(lmer = T)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with
## max|grad| = 0.0100517 (tol = 0.002, component 1)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  3 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.99 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.49 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.98 Generalizability of average time points across all items (Random time effects)
Rc   =  0.65 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.98 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.53 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by lmer 
             variance Percent
ID               0.21    0.23
Time             0.00    0.00
Items            0.00    0.00
ID x time        0.16    0.17
ID x items       0.08    0.09
time x items     0.21    0.23
Residual         0.26    0.28
Total            0.94    1.00

 The nested components of variance estimated from lmer are:
         variance Percent
id           0.24    0.33
id(time)     0.13    0.18
residual     0.35    0.49
total        0.72    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="self-esteem" class="section level3">
<h3>Self esteem</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number,self_esteem_1) %&gt;%
  multi_rel(lmer = F)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  1 items.

 Alternative estimates of reliability based upon Generalizability theory

RkRn =  0.97 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.86 Generalizability of within person variations averaged over items  (time nested within people)
 The nested components of variance estimated from lme are:
         Variance Percent
id           0.59    0.43
id(time)     0.67    0.49
residual     0.11    0.08
total        1.37    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="satisfaction-with-sexual-intercourse" class="section level3">
<h3>Satisfaction with sexual intercourse</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, desirability_partner) %&gt;%
  multi_rel(lmer = F)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  1 items.

 Alternative estimates of reliability based upon Generalizability theory

RkRn =  0.96 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.86 Generalizability of within person variations averaged over items  (time nested within people)
 The nested components of variance estimated from lme are:
         Variance Percent
id           0.84   0.402
id(time)     1.07   0.512
residual     0.18   0.086
total        2.09   1.000

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="relationship-satisfaction-1" class="section level3">
<h3>Relationship satisfaction</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, relationship_satisfaction_1) %&gt;%
  multi_rel(lmer = F)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  1 items.

 Alternative estimates of reliability based upon Generalizability theory

RkRn =  0.97 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.86 Generalizability of within person variations averaged over items  (time nested within people)
 The nested components of variance estimated from lme are:
         Variance Percent
id           0.65    0.43
id(time)     0.73    0.49
residual     0.12    0.08
total        1.50    1.00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="partner-initiated-sex" class="section level3">
<h3>Partner initiated sex</h3>
<pre class="r"><code>diary %&gt;% 
  select(person, day_number, partner_initiated_sexual_intercourse) %&gt;%
  multi_rel(lmer = F)</code></pre>
<pre><code>
Multilevel Generalizability analysis   
Call: multilevel.reliability(x = ., grp = &quot;person&quot;, Time = &quot;day_number&quot;, 
    items = &quot;variable&quot;, aov = F, lmer = lmer, lme = lme, long = T, 
    values = &quot;value&quot;)

The data had  1054  observations taken over  41  time intervals for  1 items.

 Alternative estimates of reliability based upon Generalizability theory

RkRn =  0.72 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0.89 Generalizability of within person variations averaged over items  (time nested within people)
 The nested components of variance estimated from lme are:
         Variance Percent
id          0.014   0.059
id(time)    0.200   0.837
residual    0.025   0.105
total       0.239   1.000

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div id="extra-pair-sex-frequency" class="section level3">
<h3>Extra-pair sex frequency</h3>
<pre class="r"><code>sex_summary = diary %&gt;% 
  group_by(hormonal_contraception,person) %&gt;% 
  summarise(n_days = n(), 
            n_extra_pair_sex = sum(extra_pair_sex,na.rm = T),
            n_extra_pair_intimacy = sum(extra_pair_intimacy,na.rm = T),
            n_sex = sum(had_sexual_intercourse,na.rm = T),
            n_petting = sum(had_petting,na.rm = T))

table(diary$extra_pair_sex) %&gt;% pander()</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">28600</td>
<td align="center">129</td>
</tr>
</tbody>
</table>
<pre class="r"><code>prop.table(table(diary$extra_pair_sex)) %&gt;% pander()</code></pre>
<table style="width:26%;">
<colgroup>
<col width="12%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.9955</td>
<td align="center">0.00449</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ggplot(sex_summary, aes(n_extra_pair_sex)) + geom_bar() + scale_y_log10(breaks = c(1,5,10,100,1000))</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<pre class="r"><code>xtabs(~ hormonal_contraception + n_extra_pair_sex, data = sex_summary) %&gt;% pander()</code></pre>
<table style="width:68%;">
<colgroup>
<col width="12%" />
<col width="8%" />
<col width="6%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">7</th>
<th align="center">8</th>
<th align="center">11</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>0</strong></td>
<td align="center">401</td>
<td align="center">9</td>
<td align="center">8</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>1</strong></td>
<td align="center">604</td>
<td align="center">11</td>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>xtabs(~ hormonal_contraception + I(n_extra_pair_sex&gt;0), data = sex_summary) %&gt;% pander()</code></pre>
<table style="width:35%;">
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>0</strong></td>
<td align="center">401</td>
<td align="center">28</td>
</tr>
<tr class="even">
<td align="center"><strong>1</strong></td>
<td align="center">604</td>
<td align="center">21</td>
</tr>
</tbody>
</table>
</div>
<div id="extra-pair-intimacy-frequency" class="section level3">
<h3>Extra-pair intimacy frequency</h3>
<pre class="r"><code>table(diary$extra_pair_intimacy) %&gt;% pander()</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">27442</td>
<td align="center">385</td>
</tr>
</tbody>
</table>
<pre class="r"><code>prop.table(table(diary$extra_pair_intimacy)) %&gt;% pander()</code></pre>
<table style="width:26%;">
<colgroup>
<col width="12%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.9862</td>
<td align="center">0.01384</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ggplot(sex_summary, aes(n_extra_pair_intimacy)) + geom_bar() + scale_y_log10(breaks = c(1,5,10,100,1000))</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<pre class="r"><code>xtabs(~ hormonal_contraception + n_extra_pair_intimacy, data = sex_summary) %&gt;% pander()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="9%" />
<col width="6%" />
<col width="5%" />
<col width="5%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
<th align="center">9</th>
<th align="center">10</th>
<th align="center">11</th>
<th align="center">12</th>
<th align="center">13</th>
<th align="center">18</th>
<th align="center">19</th>
<th align="center">20</th>
<th align="center">30</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>0</strong></td>
<td align="center">365</td>
<td align="center">29</td>
<td align="center">11</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>1</strong></td>
<td align="center">576</td>
<td align="center">27</td>
<td align="center">9</td>
<td align="center">4</td>
<td align="center">6</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>xtabs(~ hormonal_contraception + I(n_extra_pair_intimacy&gt;0), data = sex_summary) %&gt;% pander()</code></pre>
<table style="width:35%;">
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>0</strong></td>
<td align="center">365</td>
<td align="center">64</td>
</tr>
<tr class="even">
<td align="center"><strong>1</strong></td>
<td align="center">576</td>
<td align="center">49</td>
</tr>
</tbody>
</table>
</div>
<div id="sexual-intercourse-frequency" class="section level3">
<h3>Sexual intercourse frequency</h3>
<pre class="r"><code>table(diary$had_sexual_intercourse) %&gt;% pander()</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">21758</td>
<td align="center">6070</td>
</tr>
</tbody>
</table>
<pre class="r"><code>prop.table(table(diary$had_sexual_intercourse)) %&gt;% pander()</code></pre>
<table style="width:25%;">
<colgroup>
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.7819</td>
<td align="center">0.2181</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ggplot(sex_summary, aes(n_sex)) + geom_bar() + scale_y_log10(breaks = c(1,5,10,100,1000))</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<pre class="r"><code>ggplot(sex_summary, aes(n_sex/n_days)) + geom_histogram(binwidth = 0.01) + scale_y_log10(breaks = c(1,5,10,100,1000))</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 25 rows containing missing values (geom_bar).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-63-2.png" width="672" /></p>
<pre class="r"><code>ggplot(sex_summary, aes(n_sex, n_days)) + geom_jitter(alpha = 0.1) + geom_abline(slope = 1, intercept = 0)</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-63-3.png" width="672" /></p>
<pre class="r"><code>xtabs(~ hormonal_contraception + n_sex, data = sex_summary) %&gt;% pander()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="5%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
<th align="center">9</th>
<th align="center">10</th>
<th align="center">11</th>
<th align="center">12</th>
<th align="center">13</th>
<th align="center">14</th>
<th align="center">15</th>
<th align="center">16</th>
<th align="center">17</th>
<th align="center">18</th>
<th align="center">19</th>
<th align="center">20</th>
<th align="center">21</th>
<th align="center">22</th>
<th align="center">23</th>
<th align="center">24</th>
<th align="center">25</th>
<th align="center">26</th>
<th align="center">28</th>
<th align="center">32</th>
<th align="center">34</th>
<th align="center">35</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>0</strong></td>
<td align="center">103</td>
<td align="center">48</td>
<td align="center">33</td>
<td align="center">28</td>
<td align="center">41</td>
<td align="center">19</td>
<td align="center">24</td>
<td align="center">22</td>
<td align="center">10</td>
<td align="center">23</td>
<td align="center">19</td>
<td align="center">16</td>
<td align="center">8</td>
<td align="center">10</td>
<td align="center">7</td>
<td align="center">5</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>1</strong></td>
<td align="center">76</td>
<td align="center">46</td>
<td align="center">43</td>
<td align="center">49</td>
<td align="center">44</td>
<td align="center">40</td>
<td align="center">53</td>
<td align="center">53</td>
<td align="center">33</td>
<td align="center">31</td>
<td align="center">36</td>
<td align="center">29</td>
<td align="center">20</td>
<td align="center">17</td>
<td align="center">11</td>
<td align="center">13</td>
<td align="center">7</td>
<td align="center">6</td>
<td align="center">4</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>xtabs(~ hormonal_contraception + I(n_sex&gt;0), data = sex_summary) %&gt;% pander()</code></pre>
<table style="width:35%;">
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>0</strong></td>
<td align="center">103</td>
<td align="center">326</td>
</tr>
<tr class="even">
<td align="center"><strong>1</strong></td>
<td align="center">76</td>
<td align="center">549</td>
</tr>
</tbody>
</table>
<pre class="r"><code>sex_summary %&gt;% filter(n_days &gt; 25) %&gt;% group_by(hormonal_contraception) %&gt;% summarise(sex = sum(n_sex&gt;0), no_sex = sum(n_sex==0)) %&gt;% pander()</code></pre>
<table style="width:56%;">
<colgroup>
<col width="34%" />
<col width="8%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">hormonal_contraception</th>
<th align="center">sex</th>
<th align="center">no_sex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">249</td>
<td align="center">38</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">432</td>
<td align="center">31</td>
</tr>
</tbody>
</table>
</div>
<div id="petting-frequency" class="section level3">
<h3>Petting frequency</h3>
<pre class="r"><code>table(diary$had_petting) %&gt;% pander()</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">22378</td>
<td align="center">5449</td>
</tr>
</tbody>
</table>
<pre class="r"><code>prop.table(table(diary$had_petting)) %&gt;% pander()</code></pre>
<table style="width:25%;">
<colgroup>
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.8042</td>
<td align="center">0.1958</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ggplot(sex_summary, aes(n_petting)) + geom_bar() + scale_y_log10(breaks = c(1,5,10,100,1000))</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<pre class="r"><code>ggplot(sex_summary, aes(n_petting/n_days)) + geom_histogram(binwidth = 0.01) + scale_y_log10(breaks = c(1,5,10,100,1000))</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>## Warning: Removed 26 rows containing missing values (geom_bar).</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-64-2.png" width="672" /></p>
<pre class="r"><code>xtabs(~ hormonal_contraception + n_petting, data = sex_summary) %&gt;% pander()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="5%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
<th align="center">9</th>
<th align="center">10</th>
<th align="center">11</th>
<th align="center">12</th>
<th align="center">13</th>
<th align="center">14</th>
<th align="center">15</th>
<th align="center">16</th>
<th align="center">17</th>
<th align="center">18</th>
<th align="center">19</th>
<th align="center">20</th>
<th align="center">21</th>
<th align="center">22</th>
<th align="center">23</th>
<th align="center">24</th>
<th align="center">25</th>
<th align="center">26</th>
<th align="center">27</th>
<th align="center">29</th>
<th align="center">32</th>
<th align="center">34</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>0</strong></td>
<td align="center">113</td>
<td align="center">55</td>
<td align="center">40</td>
<td align="center">27</td>
<td align="center">28</td>
<td align="center">31</td>
<td align="center">20</td>
<td align="center">22</td>
<td align="center">14</td>
<td align="center">12</td>
<td align="center">12</td>
<td align="center">14</td>
<td align="center">5</td>
<td align="center">7</td>
<td align="center">4</td>
<td align="center">6</td>
<td align="center">4</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>1</strong></td>
<td align="center">102</td>
<td align="center">60</td>
<td align="center">44</td>
<td align="center">54</td>
<td align="center">49</td>
<td align="center">59</td>
<td align="center">39</td>
<td align="center">42</td>
<td align="center">28</td>
<td align="center">18</td>
<td align="center">33</td>
<td align="center">23</td>
<td align="center">17</td>
<td align="center">9</td>
<td align="center">10</td>
<td align="center">7</td>
<td align="center">5</td>
<td align="center">3</td>
<td align="center">4</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">4</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>xtabs(~ hormonal_contraception + I(n_petting&gt;0), data = sex_summary) %&gt;% pander()</code></pre>
<table style="width:35%;">
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>0</strong></td>
<td align="center">113</td>
<td align="center">316</td>
</tr>
<tr class="even">
<td align="center"><strong>1</strong></td>
<td align="center">102</td>
<td align="center">523</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="measurement-reactivity" class="section level2">
<h2>Measurement Reactivity</h2>
<p>We test whether our analyses are robust to adjustments for measurement reactivity (operationalised as nonlinear time trends over number of days since the beginning of the diary, and over number of days filled out, ). The first approach do this is to test whether our main predictor, probability of being in the fertile window, varies systematically over days. This might happen, if women are more likely to begin our fill out the diary on (non)fertile days.</p>
<p>Because these analyses show small relationships to the predictor, that differ by hormonal contraception, we think it is worth testing if our results are robust to the inclusion of splines over days (since beginning/filled out).</p>
<pre class="r"><code>library(gamm4)
diary %&gt;% mutate(
    included = included_all,
    fertile = if_else(is.na(prc_stirn_b_squished), prc_stirn_b_backward_inferred, prc_stirn_b_squished)
) %&gt;% group_by(person) %&gt;% mutate(days_filled_out = row_number(day_number)) %&gt;% filter(day_number &lt; 40, days_filled_out &lt; 37) %&gt;% 
gamm4(fertile ~ s(day_number, by = included)+ s(days_filled_out, by = included), ~ (1|person), data = .) -&gt; trend
summary(trend$mer)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## 
## REML criterion at convergence: -10915
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -1.762 -0.742 -0.483  0.705  2.532 
## 
## Random effects:
##  Groups   Name                                   Variance Std.Dev.
##  person   (Intercept)                            0.00224  0.0473  
##  Xr.2     s(days_filled_out):includedhorm_contra 0.02012  0.1419  
##  Xr.1     s(days_filled_out):includedcycling     0.02246  0.1499  
##  Xr.0     s(day_number):includedhorm_contra      0.00000  0.0000  
##  Xr       s(day_number):includedcycling          0.00257  0.0506  
##  Residual                                        0.03637  0.1907  
## Number of obs: 24942, groups:  person, 1054; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8
## 
## Fixed effects:
##                                            Estimate Std. Error t value
## X(Intercept)                                0.17166    0.00200   85.75
## Xs(day_number):includedcyclingFx1          -0.00160    0.01974   -0.08
## Xs(day_number):includedhorm_contraFx1       0.01262    0.00688    1.84
## Xs(days_filled_out):includedcyclingFx1     -0.00308    0.03086   -0.10
## Xs(days_filled_out):includedhorm_contraFx1  0.01100    0.02390    0.46
## 
## Correlation of Fixed Effects:
##             X(Int) X(_):F X(_):_ X(__):F
## Xs(dy_n):F1 -0.036                      
## Xs(dy_):_F1 -0.035  0.001               
## Xs(dy__):F1  0.031 -0.439 -0.001        
## Xs(d__):_F1  0.014  0.000 -0.256  0.000</code></pre>
<pre class="r"><code>summary(trend$gam)</code></pre>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## fertile ~ s(day_number, by = included) + s(days_filled_out, by = included)
## &lt;environment: 0x7f9c99ca2910&gt;
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    0.172      0.002    85.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                                         edf Ref.df     F p-value    
## s(day_number):includedcycling          3.03   3.03  4.19 0.00557 ** 
## s(day_number):includedhorm_contra      1.00   1.00  3.37 0.06639 .  
## s(days_filled_out):includedcycling     5.96   5.96  4.35 0.00029 ***
## s(days_filled_out):includedhorm_contra 6.52   6.52 13.27 5.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.00563   
## lmer.REML = -10915  Scale est. = 0.036367  n = 24942</code></pre>
<pre class="r"><code>plot(trend$gam, pages = 1)</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
</div>
<div id="contraception" class="section level2">
<h2>Contraception</h2>
<div id="very-broad-categories-of-contraceptive-methods-as-used-in-the-analyses" class="section level3">
<h3>Very broad categories of contraceptive methods, as used in the analyses</h3>
<pre class="r"><code>xsection &lt;- xsection %&gt;% tbl_df()
count(xsection %&gt;% tbl_df(), vars = contraceptive_method) %&gt;% arrange(desc(n)) %&gt;% mutate(percent = round(n/sum(n),2)) %&gt;% filter(n &gt; 2) %&gt;% data.frame() %&gt;% pander()</code></pre>
<table style="width:56%;">
<colgroup>
<col width="33%" />
<col width="8%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">vars</th>
<th align="center">n</th>
<th align="center">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">hormonal</td>
<td align="center">625</td>
<td align="center">0.59</td>
</tr>
<tr class="even">
<td align="center">barrier_or_abstinence</td>
<td align="center">293</td>
<td align="center">0.28</td>
</tr>
<tr class="odd">
<td align="center">none</td>
<td align="center">73</td>
<td align="center">0.07</td>
</tr>
<tr class="even">
<td align="center">fertility_awareness</td>
<td align="center">53</td>
<td align="center">0.05</td>
</tr>
<tr class="odd">
<td align="center">other</td>
<td align="center">10</td>
<td align="center">0.01</td>
</tr>
</tbody>
</table>
</div>
<div id="of-hormonal-contraceptives-pill" class="section level3">
<h3>Of hormonal contraceptives: pill</h3>
<pre class="r"><code>xsection %&gt;% filter(contraceptive_method == &#39;hormonal&#39;) %&gt;% mutate(contraceptive_pill = contraception %contains% &quot;contraceptive_pill&quot;) %&gt;% count(vars = contraceptive_pill) %&gt;% arrange(desc(n)) %&gt;% mutate(percent = round(n/sum(n),2)) %&gt;% filter(n &gt; 2) %&gt;% data.frame() %&gt;% pander()</code></pre>
<table style="width:33%;">
<colgroup>
<col width="11%" />
<col width="8%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">vars</th>
<th align="center">n</th>
<th align="center">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">TRUE</td>
<td align="center">549</td>
<td align="center">0.88</td>
</tr>
<tr class="even">
<td align="center">FALSE</td>
<td align="center">76</td>
<td align="center">0.12</td>
</tr>
</tbody>
</table>
</div>
<div id="of-non-pill-methods-other-methods" class="section level3">
<h3>Of non-pill methods, other methods</h3>
<pre class="r"><code>otherhormmethods = c(&quot;1&quot; = &quot;depot-injected&quot;, &quot;2&quot; = &quot;hormonal implant&quot;, &quot;3&quot; = &quot;vaginal ring&quot;, &quot;4&quot; = &quot;contraceptive patch&quot;, &quot;5&quot; = &quot;hormonal IUD&quot;)
xsection = xsection %&gt;% mutate(other_hormonal_methods = otherhormmethods[hormonal_1])
xsection %&gt;% filter(contraceptive_method == &#39;hormonal&#39;) %&gt;% mutate(contraceptive_pill = contraception %contains% &quot;contraceptive_pill&quot;) %&gt;% filter(contraceptive_pill == F) %&gt;% count(vars = other_hormonal_methods) %&gt;% arrange(desc(n)) %&gt;% mutate(percent = round(n/sum(n),2)) %&gt;% filter(n &gt; 2) %&gt;% data.frame() %&gt;% pander()</code></pre>
<table style="width:47%;">
<colgroup>
<col width="26%" />
<col width="6%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">vars</th>
<th align="center">n</th>
<th align="center">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">NA</td>
<td align="center">31</td>
<td align="center">0.41</td>
</tr>
<tr class="even">
<td align="center">vaginal ring</td>
<td align="center">26</td>
<td align="center">0.34</td>
</tr>
<tr class="odd">
<td align="center">hormonal IUD</td>
<td align="center">12</td>
<td align="center">0.16</td>
</tr>
<tr class="even">
<td align="center">depot-injected</td>
<td align="center">3</td>
<td align="center">0.04</td>
</tr>
<tr class="odd">
<td align="center">hormonal implant</td>
<td align="center">3</td>
<td align="center">0.04</td>
</tr>
</tbody>
</table>
<pre class="r"><code>cat(&quot;missings occurred here, because we asked about these only after the diary and not everyone finished&quot;)</code></pre>
<pre><code>## missings occurred here, because we asked about these only after the diary and not everyone finished</code></pre>
</div>
<div id="slightly-more-differentiated-contraceptive-methods" class="section level3">
<h3>Slightly more differentiated contraceptive methods</h3>
<pre class="r"><code>count(xsection, vars = contraceptives_broad_categories) %&gt;% arrange(desc(n)) %&gt;% mutate(percent = round(n/sum(n),2)) %&gt;% filter(n &gt; 2) %&gt;% data.frame() %&gt;% pander()</code></pre>
<table style="width:75%;">
<colgroup>
<col width="52%" />
<col width="8%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">vars</th>
<th align="center">n</th>
<th align="center">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">contraceptive_pill</td>
<td align="center">410</td>
<td align="center">0.39</td>
</tr>
<tr class="even">
<td align="center">condoms</td>
<td align="center">189</td>
<td align="center">0.18</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill, condoms</td>
<td align="center">124</td>
<td align="center">0.12</td>
</tr>
<tr class="even">
<td align="center">none</td>
<td align="center">73</td>
<td align="center">0.07</td>
</tr>
<tr class="odd">
<td align="center">other_hormonal</td>
<td align="center">68</td>
<td align="center">0.06</td>
</tr>
<tr class="even">
<td align="center">intrauterine_pessar</td>
<td align="center">47</td>
<td align="center">0.04</td>
</tr>
<tr class="odd">
<td align="center">occasionally_use_coitus_interruptus</td>
<td align="center">47</td>
<td align="center">0.04</td>
</tr>
<tr class="even">
<td align="center">other</td>
<td align="center">45</td>
<td align="center">0.04</td>
</tr>
<tr class="odd">
<td align="center">counting_and_or_temperature_methods</td>
<td align="center">42</td>
<td align="center">0.04</td>
</tr>
<tr class="even">
<td align="center">partner_sterilised</td>
<td align="center">9</td>
<td align="center">0.01</td>
</tr>
</tbody>
</table>
</div>
<div id="methods-as-reported-by-at-least-3-women" class="section level3">
<h3>Methods as reported by at least 3 women</h3>
<pre class="r"><code>count(xsection, vars = contraception) %&gt;% arrange(desc(n)) %&gt;% mutate(percent = round(n/sum(n),2)) %&gt;% filter(n &gt; 2) %&gt;% data.frame() %&gt;% pander()</code></pre>
<table style="width:67%;">
<colgroup>
<col width="44%" />
<col width="8%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">vars</th>
<th align="center">n</th>
<th align="center">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">contraceptive_pill</td>
<td align="center">410</td>
<td align="center">0.39</td>
</tr>
<tr class="even">
<td align="center">condoms</td>
<td align="center">189</td>
<td align="center">0.18</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill, condoms</td>
<td align="center">124</td>
<td align="center">0.12</td>
</tr>
<tr class="even">
<td align="center">none</td>
<td align="center">73</td>
<td align="center">0.07</td>
</tr>
<tr class="odd">
<td align="center">other_hormonal</td>
<td align="center">68</td>
<td align="center">0.06</td>
</tr>
<tr class="even">
<td align="center">intrauterine_pessar</td>
<td align="center">47</td>
<td align="center">0.04</td>
</tr>
<tr class="odd">
<td align="center">condoms, kalendermethode</td>
<td align="center">12</td>
<td align="center">0.01</td>
</tr>
<tr class="even">
<td align="center">condoms, coitus_interruptus</td>
<td align="center">11</td>
<td align="center">0.01</td>
</tr>
<tr class="odd">
<td align="center">coitus_interruptus</td>
<td align="center">10</td>
<td align="center">0.01</td>
</tr>
<tr class="even">
<td align="center">partner_sterilised</td>
<td align="center">9</td>
<td align="center">0.01</td>
</tr>
<tr class="odd">
<td align="center">condoms, temperature_billings</td>
<td align="center">8</td>
<td align="center">0.01</td>
</tr>
<tr class="even">
<td align="center">none, condoms</td>
<td align="center">7</td>
<td align="center">0.01</td>
</tr>
<tr class="odd">
<td align="center">other_hormonal, condoms</td>
<td align="center">7</td>
<td align="center">0.01</td>
</tr>
<tr class="even">
<td align="center">andere</td>
<td align="center">6</td>
<td align="center">0.01</td>
</tr>
<tr class="odd">
<td align="center">condoms, kalendermethode, coitus_interruptus</td>
<td align="center">5</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">kalendermethode</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">kalendermethode, coitus_interruptus</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">none, coitus_interruptus</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">none, partner_sterilised</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">condoms, intrauterine_pessar</td>
<td align="center">3</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill, condoms, coitus_interruptus</td>
<td align="center">3</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">kalendermethode, temperature_billings</td>
<td align="center">3</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>common &lt;- head((count(xsection, vars=contraception) %&gt;% arrange(desc(n)))$vars,10)
commoncontra = xsection %&gt;% filter(contraception %in% common)

bar_count(commoncontra, contraception)</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
<div id="common-pill-brands" class="section level3">
<h3>Common pill brands</h3>
<pre class="r"><code>count(xsection, vars=pills) %&gt;% filter(!is.na(vars)) %&gt;% arrange(desc(n)) %&gt;% mutate(percent = round(n/sum(n),2)) %&gt;% filter(n &gt; 10) %&gt;% data.frame() %&gt;% pander()</code></pre>
<table style="width:49%;">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">vars</th>
<th align="center">n</th>
<th align="center">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">maxim</td>
<td align="center">88</td>
<td align="center">0.16</td>
</tr>
<tr class="even">
<td align="center">other</td>
<td align="center">48</td>
<td align="center">0.09</td>
</tr>
<tr class="odd">
<td align="center">belara</td>
<td align="center">25</td>
<td align="center">0.05</td>
</tr>
<tr class="even">
<td align="center">velafee</td>
<td align="center">25</td>
<td align="center">0.05</td>
</tr>
<tr class="odd">
<td align="center">lamuna_20</td>
<td align="center">24</td>
<td align="center">0.04</td>
</tr>
<tr class="even">
<td align="center">valette</td>
<td align="center">21</td>
<td align="center">0.04</td>
</tr>
<tr class="odd">
<td align="center">microgynon</td>
<td align="center">16</td>
<td align="center">0.03</td>
</tr>
<tr class="even">
<td align="center">asumate_20</td>
<td align="center">15</td>
<td align="center">0.03</td>
</tr>
<tr class="odd">
<td align="center">chariva</td>
<td align="center">15</td>
<td align="center">0.03</td>
</tr>
<tr class="even">
<td align="center">evaluna_20</td>
<td align="center">15</td>
<td align="center">0.03</td>
</tr>
<tr class="odd">
<td align="center">minisiston_20_fem</td>
<td align="center">15</td>
<td align="center">0.03</td>
</tr>
<tr class="even">
<td align="center">leonahexal</td>
<td align="center">12</td>
<td align="center">0.02</td>
</tr>
<tr class="odd">
<td align="center">aida</td>
<td align="center">11</td>
<td align="center">0.02</td>
</tr>
<tr class="even">
<td align="center">bellissima</td>
<td align="center">11</td>
<td align="center">0.02</td>
</tr>
<tr class="odd">
<td align="center">minisiston</td>
<td align="center">11</td>
<td align="center">0.02</td>
</tr>
</tbody>
</table>
</div>
<div id="contraception-and-cycle-regularity" class="section level3">
<h3>Contraception and cycle regularity</h3>
<div id="reported-any-period" class="section level4">
<h4>reported any period?</h4>
<p>this includes the whole sample, because having a period was a mandatory inclusion criterion</p>
<pre class="r"><code>crosstabs(~ had_any_period + contraceptive_method , data = xsection2)  %&gt;% 
  prop.table(2) %&gt;% 
  round(2) %&gt;% 
  pander()</code></pre>
<table>
<colgroup>
<col width="14%" />
<col width="28%" />
<col width="26%" />
<col width="13%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">barrier_or_abstinence</th>
<th align="center">fertility_awareness</th>
<th align="center">hormonal</th>
<th align="center">none</th>
<th align="center">other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>FALSE</strong></td>
<td align="center">0.09</td>
<td align="center">0.11</td>
<td align="center">0.09</td>
<td align="center">0.21</td>
<td align="center">0.26</td>
</tr>
<tr class="even">
<td align="center"><strong>TRUE</strong></td>
<td align="center">0.91</td>
<td align="center">0.89</td>
<td align="center">0.91</td>
<td align="center">0.79</td>
<td align="center">0.74</td>
</tr>
</tbody>
</table>
<pre class="r"><code>crosstabs(~ had_any_period + contraceptive_method , data = xsection2 %&gt;% filter(n_days &gt; 20))  %&gt;% 
  round(2) %&gt;% 
  pander()</code></pre>
<table>
<colgroup>
<col width="14%" />
<col width="28%" />
<col width="26%" />
<col width="13%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">barrier_or_abstinence</th>
<th align="center">fertility_awareness</th>
<th align="center">hormonal</th>
<th align="center">none</th>
<th align="center">other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>FALSE</strong></td>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">19</td>
<td align="center">10</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center"><strong>TRUE</strong></td>
<td align="center">202</td>
<td align="center">38</td>
<td align="center">479</td>
<td align="center">50</td>
<td align="center">11</td>
</tr>
</tbody>
</table>
<pre class="r"><code>xsection2 %&gt;% filter(n_days &gt; 20, contraceptive_method == &#39;hormonal&#39;, !had_any_period) %&gt;% select(contraception, age, n_days, pills) %&gt;% pander()</code></pre>
<table style="width:81%;">
<colgroup>
<col width="41%" />
<col width="8%" />
<col width="12%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contraception</th>
<th align="center">age</th>
<th align="center">n_days</th>
<th align="center">pills</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">none, contraceptive_pill</td>
<td align="center">24</td>
<td align="center">29</td>
<td align="center">evaluna_30</td>
</tr>
<tr class="even">
<td align="center">other_hormonal</td>
<td align="center">50</td>
<td align="center">24</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill, condoms</td>
<td align="center">23</td>
<td align="center">39</td>
<td align="center">seculact</td>
</tr>
<tr class="even">
<td align="center">contraceptive_pill</td>
<td align="center">22</td>
<td align="center">33</td>
<td align="center">desirett</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill</td>
<td align="center">24</td>
<td align="center">29</td>
<td align="center">desirett</td>
</tr>
<tr class="even">
<td align="center">other_hormonal</td>
<td align="center">49</td>
<td align="center">30</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill</td>
<td align="center">21</td>
<td align="center">26</td>
<td align="center">zoely</td>
</tr>
<tr class="even">
<td align="center">other_hormonal</td>
<td align="center">24</td>
<td align="center">30</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill</td>
<td align="center">20</td>
<td align="center">30</td>
<td align="center">lamuna_20</td>
</tr>
<tr class="even">
<td align="center">other_hormonal</td>
<td align="center">24</td>
<td align="center">38</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">other_hormonal</td>
<td align="center">27</td>
<td align="center">34</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">contraceptive_pill, condoms</td>
<td align="center">23</td>
<td align="center">31</td>
<td align="center">bellissima</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill</td>
<td align="center">33</td>
<td align="center">29</td>
<td align="center">desmin_20</td>
</tr>
<tr class="even">
<td align="center">contraceptive_pill</td>
<td align="center">22</td>
<td align="center">39</td>
<td align="center">maxim</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill</td>
<td align="center">24</td>
<td align="center">30</td>
<td align="center">jubrele</td>
</tr>
<tr class="even">
<td align="center">contraceptive_pill</td>
<td align="center">30</td>
<td align="center">28</td>
<td align="center">cilest</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill, condoms</td>
<td align="center">37</td>
<td align="center">30</td>
<td align="center">other</td>
</tr>
<tr class="even">
<td align="center">contraceptive_pill</td>
<td align="center">20</td>
<td align="center">28</td>
<td align="center">maxim</td>
</tr>
<tr class="odd">
<td align="center">contraceptive_pill</td>
<td align="center">18</td>
<td align="center">38</td>
<td align="center">other</td>
</tr>
</tbody>
</table>
<pre class="r"><code>crosstabs(~ cycle_length_groups + contraceptive_method , data = xsection)  %&gt;% 
  prop.table(2) %&gt;% 
  round(2) %&gt;% 
  pander()</code></pre>
<table>
<colgroup>
<col width="16%" />
<col width="27%" />
<col width="25%" />
<col width="12%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">barrier_or_abstinence</th>
<th align="center">fertility_awareness</th>
<th align="center">hormonal</th>
<th align="center">none</th>
<th align="center">other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(19,25]</strong></td>
<td align="center">0.13</td>
<td align="center">0.08</td>
<td align="center">0.16</td>
<td align="center">0.12</td>
<td align="center">0.1</td>
</tr>
<tr class="even">
<td align="center"><strong>(25,30]</strong></td>
<td align="center">0.65</td>
<td align="center">0.74</td>
<td align="center">0.77</td>
<td align="center">0.62</td>
<td align="center">0.8</td>
</tr>
<tr class="odd">
<td align="center"><strong>(30,35]</strong></td>
<td align="center">0.17</td>
<td align="center">0.19</td>
<td align="center">0.04</td>
<td align="center">0.16</td>
<td align="center">0.1</td>
</tr>
<tr class="even">
<td align="center"><strong>(35,41]</strong></td>
<td align="center">0.05</td>
<td align="center">0</td>
<td align="center">0.03</td>
<td align="center">0.1</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>xsection  %&gt;% 
  group_by(contraceptive_method) %&gt;% 
  summarise(cycle_length = mean(cycle_length, na.rm = T), sd = sd(cycle_length, na.rm = T), n = n()) %&gt;% 
  pander()</code></pre>
<table style="width:69%;">
<colgroup>
<col width="33%" />
<col width="20%" />
<col width="6%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">contraceptive_method</th>
<th align="center">cycle_length</th>
<th align="center">sd</th>
<th align="center">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">barrier_or_abstinence</td>
<td align="center">29</td>
<td align="center">NA</td>
<td align="center">293</td>
</tr>
<tr class="even">
<td align="center">fertility_awareness</td>
<td align="center">29.04</td>
<td align="center">NA</td>
<td align="center">53</td>
</tr>
<tr class="odd">
<td align="center">hormonal</td>
<td align="center">27.96</td>
<td align="center">NA</td>
<td align="center">625</td>
</tr>
<tr class="even">
<td align="center">none</td>
<td align="center">29.62</td>
<td align="center">NA</td>
<td align="center">73</td>
</tr>
<tr class="odd">
<td align="center">other</td>
<td align="center">28.4</td>
<td align="center">NA</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
<pre class="r"><code>qplot(cycle_length, data = xsection, binwidth = 1) + facet_wrap(~ contraceptive_method, scales = &quot;free_y&quot;)</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<pre class="r"><code>qplot(cycle_length, data = xsection, binwidth = 1) + facet_wrap(~ contraceptive_method_by_pearl, scales = &quot;free_y&quot;)</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-72-2.png" width="672" /></p>
<pre class="r"><code>xsection %&gt;% select(cycle_length, partner_attractiveness_physical,partner_attractiveness_shortterm, partner_attractiveness_rel_to_self, ZIP, duration_relationship_total) %&gt;% cor(use=&#39;pairwise.complete.obs&#39;) %&gt;% round(2) %&gt;% .[1, -1]</code></pre>
<pre><code>##    partner_attractiveness_physical   partner_attractiveness_shortterm partner_attractiveness_rel_to_self 
##                               0.00                              -0.01                               0.01 
##                                ZIP        duration_relationship_total 
##                               0.05                               0.09</code></pre>
</div>
</div>
</div>
<div id="origin" class="section level2">
<h2>Origin</h2>
<pre class="r"><code>plz_populations = read.csv(&quot;geo/plz_einwohner.csv&quot;)
plz_populations %&gt;% mutate(plz = str_pad(plz, 5, &quot;left&quot;, &quot;0&quot;),
                           postal_code = str_sub(plz, 1, 3)) %&gt;% 
  group_by(postal_code) %&gt;%
  summarise(einwohner = sum(einwohner, na.rm = T)) %&gt;%
  tbl_df() -&gt; plz_populations

xsection %&gt;% 
  select(postal_code) %&gt;% 
  group_by(postal_code) %&gt;% 
  summarise(count = n()) %&gt;% 
  right_join(plz_populations, by = &#39;postal_code&#39;, copy = T) %&gt;% 
  mutate(count = ifelse(is.na(count), 0, count),
    percent = count/einwohner) -&gt; origins</code></pre>
<pre><code>## Warning: Column `postal_code` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code># origins
# 
# 
library(leaflet)
# library(rgdal)           # required for readOGR and spTransform
# map &lt;- readOGR(dsn=&quot;geo/plz-3stellig.shp/&quot;, layer=&quot;plz-3stellig&quot;,verbose = F)
# library(rgeos)
# # plot(map)
# map = SpatialPolygonsDataFrame(gSimplify(map, tol = 0.001, topologyPreserve = T), data = data.frame(map))
# 
# save(map, file = &quot;geo/map.rdata&quot;)
load(&quot;geo/map.rdata&quot;)
origins = data.frame(postal_code = map$plz) %&gt;% left_join(origins, by = &#39;postal_code&#39;)</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## Warning: Column `postal_code` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code>map$count = origins$count
map$einwohner = origins$einwohner
map$percent = origins$percent
map$popup1 &lt;- paste0(&quot;Count: &quot;,             
                      map$count,         #column containing the district names
                      &quot;&lt;br&gt;Populaton: &quot;, 
                      map$einwohner)
palette &lt;- colorNumeric(c(&quot;white&quot;,&quot;red&quot;), c(0, max(log1p(origins$percent * 10000))))
map$fill = palette(log1p(map$percent * 10000))
map = map[map$count &gt; 0,]
mymap &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;OpenStreetMap.BlackAndWhite&quot;,
        options = providerTileOptions(minZoom=6, maxZoom=10)) %&gt;%
  addPolygons(data = map,
              fillColor = ~fill,
              stroke = F,
              fillOpacity = 0.6,
              popup = ~popup1
  )  %&gt;% 
  setView(9.812, 51.56, zoom = 6)

# mymap
library(htmlwidgets)
saveWidget(mymap, file = &quot;2_origin_map.html&quot;, selfcontained = F)</code></pre>
<script type='text/javascript'>
function fullScreen(element) {
  if(element.requestFullscreen) {
    element.requestFullscreen();
  } else if(element.mozRequestFullScreen) {
    element.mozRequestFullScreen();
  } else if(element.webkitRequestFullscreen) {
    element.webkitRequestFullscreen();
  } else if(element.msRequestFullscreen) {
    element.msRequestFullscreen();
  }
}

function fullwin(){
var canvas = document.getElementById('map_iframe');
fullScreen(canvas);
}
</script>
<button class="btn btn-default" onclick="fullwin();">
Show map in full screen (<kbd>Esc</kbd> to leave)
</button>
<iframe id="map_iframe" src="2_origin_map.html" style="width:100%;height:800px;border:0" allowfullscreen>
</iframe>
</div>
<div id="componentsfactors-in-preregistered-outcomes" class="section level2">
<h2>Components/factors in preregistered outcomes</h2>
<pre class="r"><code>diary %&gt;% ungroup() %&gt;%  select(extra_pair, in_pair_desire, desirability_1, had_sexual_intercourse, partner_initiated_sexual_intercourse, partner_mate_retention, sexy_clothes, NARQ_admiration, NARQ_rivalry) %&gt;%
  psych::fa.parallel(fa=&#39;pc&#39;)</code></pre>
<p><img src="2_descriptives_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  NA  and the number of components =  3</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
