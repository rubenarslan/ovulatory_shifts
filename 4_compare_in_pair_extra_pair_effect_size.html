<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Compare effect sizes</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<script src="library/auto_tab_first_section.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="library/custom_styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Fertility diary</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="1_power_analysis.html">Power analysis</a>
</li>
<li>
  <a href="1_researcher_df_analysis.html">Researcher degree of freedom simulation</a>
</li>
<li>
  <a href="1_wrangle_data.html">Data wrangling</a>
</li>
<li>
  <a href="2_descriptives.html">Descriptives</a>
</li>
<li>
  <a href="3_fertility_as_prereg.html">Preregistered analyses</a>
</li>
<li>
  <a href="3_fertility_robustness.html">Robustness tests</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<div id="compare-effect-sizes-of-ovulatory-shifts-in-in--vs-extra-pair-desire" class="section level1 tab-content">
<h1>Compare effect sizes <small>of ovulatory shifts in in- vs extra-pair desire</small></h1>
<p><span style="background:red;width:20px;height:20px;display:inline-block;"></span> Cycling women (not on hormonal birth control)</p>
<p><span style="background:black;width:20px;height:20px;display:inline-block;"></span> Women on hormonal birth control</p>
<div id="theoretical-background" class="section level2">
<h2>Theoretical background</h2>
<p>Quoting from section 5.3. of our manuscript &gt; More recent theoretical work emphasises that predictions of adaptive extra-pair sex, which Pillsworth and Haselton (2006a) call dual mating, should be divorced from predictions of ovulatory changes in mate preferences that do not necessarily precipitate extra-pair sex, but still function to bias sire choice (Gangestad, Thornhill, &amp; Garver-Apgar, 2015). We cannot test all aspects of these recent theoretical developments in our study. An alternative, simpler explanation (Roney &amp; Simmons, 2013) is based on life history theory. It suggests the observed increase in sexual desire during the fertile phase reflects a motivational priority change towards reproduction. The purported function would be to accept higher costs of sex (such as energetic and opportunity costs, or sexually transmitted infections), the more likely it is that sex leads to conception. This theory also predicts fertile phase drops in somatic investment, such as food intake (Fleischman &amp; Fessler, 2007; Roney &amp; Simmons, 2017). In this study, we did not assess any non-reproductive motivations, and we collected no data on single women. One theoretical perspective (Roney &amp; Simmons, 2013) predicts a generalized increase in sex drive with fertility across the menstrual cycle, while others more specifically predict an increase in sexual interest for certain partners (e.g. Gangestad et al., 2015). These perspectives differ in predictions of whether the effect on extra-pair desire should be larger than that on in-pair desire.</p>
<p>Here, we document why we think it is not possible to discriminate between these two theoretical accounts in our data, nor is it wise to make conclusions about whether the effect on extra-pair desire is bigger than that on in-pair desire. The latter is unwise because we did not use parallel items to assess both desire, and did not assess single women. Effect sizes were descriptively similar and item-level comparisons hinted only that effects were larger on average for items that required no object of desire to be present and no action to be taken. Ultimately, as we show in a simple forward simulation here, without having measured general, target-unspecific, desire we cannot test whether general, target-unspecific sexual motivation drives the effects on in- and extra-pair desire we find (Roney, 2009).</p>
<p>The continuous backward-counted predictor recommended in (Gangestad et al., 2016) hedges for uncertainty in the estimation of the fertile window. Our effect sizes thus account for uncertainty and reflect the estimated change when certainly in the fertile window, although the predictor never gives a more confident prediction than 58%. In Likert points from 1 to 6, the fertile window effect was 0.26 [0.17;0.35] for extra-pair desire in the robustness check data. The in-pair desire effect had the same size: 0.26 [0.10;0.42]. We could now standardise the effects by the residual standard deviation in the multilevel model to obtain an effect size estimate similar to Cohen’s d. Since the residual standard deviation of extra-pair desire is much smaller (0.61) than that of in-pair desire (1.1), their standardised estimates then differ by a factor of two.</p>
<p>However, our items for in- and extra-pair desire were not comparable and upon inspecting item-level associations in Bayesian models that appropriately account for the ordinal nature of the Likert data, we believe comparisons between the two outcomes are futile. If we can conclude anything, effects were larger on average for items that required no object of desire to be present and no action to be taken. Future studies should attempt to settle the question of whether changes in extra- or in-pair desire are independent and different in size. Most importantly, they should test whether both can be simplified to an increase in sex drive that amplifies interest in all men without affecting their rank order, i.e. mate preferences. To do so, studies should construct parallel items to measure extra-pair, in-pair, and objectless sexual desire and behaviour, and test for fertile phase changes in the rank order of ratings of male stimuli.</p>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code># cd /usr/users/rarslan/relationship_dynamics/ &amp;&amp; bsub -q mpi -W 48:00 -n 20 -R span[hosts=1] R -e &quot;filebase = &#39;3_fertility_robustness&#39;; x = rmarkdown::render(paste0(&#39;3_fertility_robustness&#39;,&#39;.Rmd&#39;), run_pandoc = FALSE, clean = FALSE); save(x, file = &#39;rob.rda&#39;); cat(readLines(paste0(filebase,&#39;.utf8.md&#39;)), sep = &#39;\n&#39;)&quot;
library(knitr)
opts_chunk$set(fig.width = 8, fig.height = 8, cache = T, warning = T, message = F, cache = F)</code></pre>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)
load(&quot;full_data.rdata&quot;)
diary = diary %&gt;% 
  mutate(
  included = included_all,
  fertile = prc_stirn_b_squished
)  %&gt;% group_by(person) %&gt;% 
  mutate(
      fertile_mean = mean(fertile, na.rm = T)
  )
opts_chunk$set(warning = F)
library(Cairo)
opts_chunk$set(dev = &quot;CairoPNG&quot;)

diary$age_group = cut(diary$age,c(18,20,25,30,35,70), include.lowest = T)</code></pre>
<pre class="r"><code>models = list()
models$extra_pair_desire = lmer(extra_pair_desire ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$in_pair_desire = lmer(in_pair_desire ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$desirability_1 = lmer(desirability_1 ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)</code></pre>
</div>
<div id="extra-pair-desire" class="section level2">
<h2>Extra-pair desire</h2>
<pre class="r"><code>summary(models$extra_pair_desire)</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: extra_pair_desire ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 34292
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.640 -0.486 -0.137  0.334  7.256 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.379    0.616   
##  Residual             0.367    0.606   
## Number of obs: 17321, groups:  person, 819
## 
## Fixed effects:
##                                       Estimate Std. Error         df t value     Pr(&gt;|t|)    
## (Intercept)                             1.8695     0.0599   969.0000   31.24      &lt; 2e-16 ***
## includedhorm_contra                    -0.1980     0.0484  1031.0000   -4.09 0.0000461413 ***
## menstruationpre                        -0.1191     0.0201 16661.0000   -5.92 0.0000000034 ***
## menstruationyes                        -0.0821     0.0237 16636.0000   -3.46      0.00054 ***
## fertile                                 0.2570     0.0458 16592.0000    5.61 0.0000000209 ***
## fertile_mean                           -0.8057     0.3120   895.0000   -2.58      0.00997 ** 
## includedhorm_contra:menstruationpre     0.0900     0.0263 16670.0000    3.42      0.00063 ***
## includedhorm_contra:menstruationyes     0.0903     0.0332 16633.0000    2.72      0.00659 ** 
## includedhorm_contra:fertile            -0.1887     0.0606 16628.0000   -3.11      0.00186 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
## inclddhrm_c             -0.478                                                               
## menstrutnpr             -0.193  0.219                                                        
## menstrutnys             -0.118  0.148  0.361                                                 
## fertile                 -0.156  0.225  0.513    0.322                                        
## fertile_men             -0.781 -0.006  0.020   -0.002   -0.033                               
## inclddhrm_cntr:mnstrtnp  0.135 -0.294 -0.765   -0.276   -0.393  0.002                        
## inclddhrm_cntr:mnstrtny  0.085 -0.188 -0.258   -0.714   -0.230  0.001  0.350                 
## inclddhrm_cntr:f         0.139 -0.300 -0.388   -0.244   -0.755 -0.002  0.525                 
##                         inclddhrm_cntr:mnstrtny
## inclddhrm_c                                    
## menstrutnpr                                    
## menstrutnys                                    
## fertile                                        
## fertile_men                                    
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny                        
## inclddhrm_cntr:f         0.319</code></pre>
</div>
<div id="in-pair-desire" class="section level2">
<h2>In-pair desire</h2>
<pre class="r"><code>summary(models$in_pair_desire)</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: in_pair_desire ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 54220
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.406 -0.683 -0.033  0.664  3.509 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.717    0.847   
##  Residual             1.188    1.090   
## Number of obs: 17321, groups:  person, 819
## 
## Fixed effects:
##                                       Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)                             3.4623     0.0862  1061.0000   40.15  &lt; 2e-16 ***
## includedhorm_contra                     0.2492     0.0704  1196.0000    3.54  0.00042 ***
## menstruationpre                        -0.0685     0.0362 16746.0000   -1.89  0.05820 .  
## menstruationyes                        -0.1469     0.0426 16733.0000   -3.45  0.00057 ***
## fertile                                 0.2557     0.0824 16662.0000    3.10  0.00191 ** 
## fertile_mean                            0.2957     0.4445   942.0000    0.67  0.50608    
## includedhorm_contra:menstruationpre     0.0372     0.0473 16754.0000    0.79  0.43080    
## includedhorm_contra:menstruationyes     0.0907     0.0597 16728.0000    1.52  0.12842    
## includedhorm_contra:fertile            -0.3562     0.1089 16718.0000   -3.27  0.00108 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
## inclddhrm_c             -0.480                                                               
## menstrutnpr             -0.238  0.269                                                        
## menstrutnys             -0.148  0.183  0.361                                                 
## fertile                 -0.194  0.278  0.514    0.322                                        
## fertile_men             -0.777 -0.006  0.023   -0.003   -0.043                               
## inclddhrm_cntr:mnstrtnp  0.167 -0.361 -0.765   -0.276   -0.394  0.002                        
## inclddhrm_cntr:mnstrtny  0.106 -0.232 -0.258   -0.714   -0.230  0.001  0.350                 
## inclddhrm_cntr:f         0.173 -0.371 -0.389   -0.243   -0.755 -0.002  0.526                 
##                         inclddhrm_cntr:mnstrtny
## inclddhrm_c                                    
## menstrutnpr                                    
## menstrutnys                                    
## fertile                                        
## fertile_men                                    
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny                        
## inclddhrm_cntr:f         0.319</code></pre>
</div>
<div id="desirability" class="section level2">
<h2>Desirability</h2>
<pre class="r"><code>summary(models$desirability_1)</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: desirability_1 ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 55270
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.035 -0.612  0.035  0.664  3.415 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.688    0.83    
##  Residual             1.267    1.13    
## Number of obs: 17325, groups:  person, 819
## 
## Fixed effects:
##                                       Estimate Std. Error         df t value   Pr(&gt;|t|)    
## (Intercept)                             3.7277     0.0854  1078.0000   43.62    &lt; 2e-16 ***
## includedhorm_contra                    -0.0094     0.0699  1234.0000   -0.13     0.8931    
## menstruationpre                        -0.1121     0.0373 16767.0000   -3.00     0.0027 ** 
## menstruationyes                        -0.2418     0.0440 16758.0000   -5.49 0.00000004 ***
## fertile                                 0.1402     0.0850 16680.0000    1.65     0.0992 .  
## fertile_mean                            0.0931     0.4393   949.0000    0.21     0.8323    
## includedhorm_contra:menstruationpre     0.0535     0.0488 16774.0000    1.10     0.2725    
## includedhorm_contra:menstruationyes     0.1079     0.0616 16752.0000    1.75     0.0799 .  
## includedhorm_contra:fertile            -0.1983     0.1124 16740.0000   -1.76     0.0777 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
## inclddhrm_c             -0.481                                                               
## menstrutnpr             -0.248  0.280                                                        
## menstrutnys             -0.154  0.191  0.361                                                 
## fertile                 -0.202  0.289  0.514    0.322                                        
## fertile_men             -0.776 -0.006  0.024   -0.003   -0.045                               
## inclddhrm_cntr:mnstrtnp  0.174 -0.374 -0.765   -0.276   -0.394  0.002                        
## inclddhrm_cntr:mnstrtny  0.111 -0.241 -0.258   -0.715   -0.230  0.001  0.350                 
## inclddhrm_cntr:f         0.181 -0.386 -0.389   -0.243   -0.755 -0.002  0.526                 
##                         inclddhrm_cntr:mnstrtny
## inclddhrm_c                                    
## menstrutnpr                                    
## menstrutnys                                    
## fertile                                        
## fertile_men                                    
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny                        
## inclddhrm_cntr:f         0.319</code></pre>
</div>
<div id="effect_size_comparison" class="section level2 active">
<h2>Comparison</h2>
<p>Here, we compare both the standardised and unstandardised effect sizes of extra-pair and in-pair desire. As we did not predict a difference, we merely test whether the estimates fall into the 95% confidence intervals of one another. Standardisation is done by dividing by the residual standard deviation.</p>
<ul>
<li>Standardised, extra-pair desire: 0.42 [0.28;0.57].</li>
<li>Unstandardised, extra-pair desire: 0.26 [0.17;0.35].</li>
<li>Standardised, in-pair desire: 0.23 [0.09;0.38].</li>
<li>Unstandardised, in-pair desire: 0.26 [0.09;0.42].</li>
<li>Standardised, desirability: 0.12 [-0.02;0.27].</li>
<li>Unstandardised, desirability: 0.14 [-0.03;0.31].</li>
</ul>
<div id="by-item" class="section level3">
<h3>By item</h3>
<pre class="r"><code>items_engl = xlsx::read.xlsx(&quot;item_tables/Daily_items_bearbeitetAM.xlsx&quot;, 1)
library(brms)
c(&#39;extra_pair_7&#39;, &#39;extra_pair_10&#39;, &#39;extra_pair_11&#39;, &#39;extra_pair_12&#39;, &#39;extra_pair_13&#39;, &#39;sexual_intercourse_1&#39;, &#39;desirability_partner&#39;, &#39;attention_2&#39;) %&gt;%
  lapply(FUN = function(x) {
    paste0(&quot;by_item/&quot;, x , &quot;.rds&quot;) %&gt;% 
    readRDS() -&gt;
      fit
    samples = fit %&gt;% posterior_samples(&quot;^b_fertile$&quot;) %&gt;%  mutate(item = x)
    newd = data.frame(person = NA, included = &quot;cycling&quot;, fertile_mean = 0.1, menstruation = &quot;no&quot;, fertile = c(0.01,0.51))
    predicted = fitted(fit, newdata = newd, summary = FALSE, re_formula = NA, allow_new_levels = F)
    predicted_sum = fitted(fit, newdata = newd, summary = T)
    #dims: 4000 samples, 2 rows, 6 levels
    multiply_by_level = rep(sort(unique(fit$data[,1])), each = dim(predicted)[1] * dim(predicted)[2]) # repeat each as many times as the first two dims
    dim(multiply_by_level) = dim(predicted)
    predicted = predicted * multiply_by_level
    response = apply(predicted, MARGIN = c(1:2), FUN = sum)
    effect = response[,2] - response[,1]
    samples$effect = effect
    samples
}) %&gt;% bind_rows() -&gt; post_samples

post_samples = post_samples %&gt;% 
  mutate(effect = if_else(item == &quot;sexual_intercourse_1&quot;, effect/5*6, effect)) %&gt;%
  mutate(in_pair = !item %contains% &quot;extra&quot;) %&gt;%
  group_by(in_pair) %&gt;%
  left_join(items_engl %&gt;% select(Item.name, Item), by = c(&quot;item&quot; = &quot;Item.name&quot;))

post_samples %&gt;% 
  summarise_at(c(&quot;b_fertile&quot;, &quot;effect&quot;),
               funs(mean = mean(.), ci_lo = quantile(., probs = 0.025), ci_hi = quantile(., probs = 0.975))) %&gt;%
  pander()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="9%" />
<col width="16%" />
<col width="13%" />
<col width="16%" />
<col width="14%" />
<col width="16%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">in_pair</th>
<th align="center">b_fertile_mean</th>
<th align="center">effect_mean</th>
<th align="center">b_fertile_ci_lo</th>
<th align="center">effect_ci_lo</th>
<th align="center">b_fertile_ci_hi</th>
<th align="center">effect_ci_hi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">FALSE</td>
<td align="center">0.511</td>
<td align="center">0.08452</td>
<td align="center">0.00772</td>
<td align="center">0.0007318</td>
<td align="center">1.027</td>
<td align="center">0.2622</td>
</tr>
<tr class="even">
<td align="center">TRUE</td>
<td align="center">0.4162</td>
<td align="center">0.1446</td>
<td align="center">0.07387</td>
<td align="center">0.02708</td>
<td align="center">0.7917</td>
<td align="center">0.2664</td>
</tr>
</tbody>
</table>
<pre class="r"><code>post_samples %&gt;% 
  mutate(Item = str_wrap(Item, 35)) %&gt;% 
  ggplot(aes(x = effect, y = Item, fill = in_pair)) +
  ggjoy::geom_joy(panel_scaling = T, color = &quot;white&quot;) + 
  scale_fill_brewer()  + ggjoy::theme_joy()</code></pre>
<p><img src="4_compare_in_pair_extra_pair_effect_size_files/figure-html/unnamed-chunk-4-1.png" width="768" /></p>
</div>
</div>
<div id="forward-simulate-generalized-sexual-desire" class="section level2 tab-content">
<h2>Forward-simulate generalized sexual desire</h2>
<p>Because we had not collected information on undirected sexual desire, we found it difficult to determine whether the effects of the fertile window on extra- vs. in-pair desire were independent or manifestations of the same generalized desire applied to different objects. See also <a href="#effect_size_comparison">effect size comparison</a>.</p>
<div id="forward-simulation-scenario-1-generalized-desire" class="section level3">
<h3>Forward-simulation, scenario 1, generalized desire</h3>
<p>Here, we simulate 500 women, measured on 30 days each. The fertile window only has an effect on generalized desire (henceforth “sexual desire”). For women whose partners is suitable (crosses the threshold of 0) object of sexual fantasies, sexual desire translates into in-pair desire, for others into extra-pair desire. We graphed a potential causal model below (in red: moderator arrows on the arrows between sexual desire and EP/IP desire as commonly done in psychology). See also this <a href="http://dagitty.net/development/dags.html?id=_6iAiM">directed acyclic graph in DAGitty</a>.</p>
<p><img src="Flow_Chart_libido.png" alt="flow chart sexual desire" /></p>
<pre class="r"><code>set.seed(5564)
source(&#39;0_helpers.R&#39;)
library(effects)
library(lme4)

yn = c(0,1)
n_person = 500
days = 30
n = n_person * days
persons = data_frame(
  person = 1:n_person,
  basic_sexual_desire = rnorm(n_person),
  desirability_of_partner = rnorm(n_person),
  desirability_of_partner_m = rnorm(n_person) + rnorm(n_person) / 3
)
sim = data_frame(
  person = rep(1:500, each = days),
    fertile = sample(yn, size = n, replace = T, prob = c(0.7, 0.3))
) %&gt;% 
  full_join(persons, by = &#39;person&#39;) %&gt;% 
mutate(
    sexual_desire = basic_sexual_desire/2  + rnorm(n)/2 + 1 * fertile,
    ep_desire = rnorm(n) + sexual_desire * ifelse(desirability_of_partner &lt; 0, 1, 0) + -1 * desirability_of_partner,
    ip_desire = rnorm(n) + sexual_desire * ifelse(desirability_of_partner &gt; 0, 1, 0) + desirability_of_partner
)</code></pre>
<div id="unobserved-patterns" class="section level4">
<h4>Unobserved patterns</h4>
<p>In our data, we cannot run this test, which shows that the effect of fertile on EP/IP desire is mediated completely by sexual desire</p>
<pre class="r"><code>summary(lmer(sexual_desire ~ fertile + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: sexual_desire ~ fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 23721
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.689 -0.662 -0.004  0.666  3.584 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.231    0.481   
##  Residual             0.254    0.504   
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##               Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)    -0.0647     0.0221   515.0000   -2.93   0.0035 ** 
## fertile         1.0056     0.0091 14534.0000  110.48   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##         (Intr)
## fertile -0.125</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ sexual_desire + fertile + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ sexual_desire + fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46123
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.661 -0.657  0.004  0.662  3.873 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.18     1.09    
##  Residual             1.13     1.06    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                  Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)       0.03350     0.04969   514.00000    0.67     0.50    
## sexual_desire     0.49127     0.01723 14989.00000   28.52   &lt;2e-16 ***
## fertile          -0.00716     0.02583 14821.00000   -0.28     0.78    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) sxl_ds
## sexual_desr  0.022       
## fertile     -0.102 -0.671</code></pre>
<pre class="r"><code>summary(lmer(ep_desire ~ sexual_desire + fertile + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ sexual_desire + fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46298
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.791 -0.670  0.004  0.671  4.205 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.19     1.09    
##  Residual             1.14     1.07    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                  Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)      -0.01121     0.04994   514.00000   -0.22     0.82    
## sexual_desire     0.48818     0.01733 14989.00000   28.17   &lt;2e-16 ***
## fertile           0.00291     0.02598 14821.00000    0.11     0.91    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) sxl_ds
## sexual_desr  0.022       
## fertile     -0.102 -0.671</code></pre>
<pre class="r"><code>summary(lmer(ep_desire ~ fertile + sexual_desire * desirability_of_partner_m + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ fertile + sexual_desire * desirability_of_partner_m +      (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46297
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.785 -0.671  0.005  0.673  4.205 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.19     1.09    
##  Residual             1.14     1.07    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                                            Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                                -0.00817     0.04994   513.00000   -0.16   0.8700    
## fertile                                     0.00363     0.02598 14821.00000    0.14   0.8889    
## sexual_desire                               0.48956     0.01733 14988.00000   28.25   &lt;2e-16 ***
## desirability_of_partner_m                   0.05979     0.04761   501.00000    1.26   0.2098    
## sexual_desire:desirability_of_partner_m     0.04014     0.01242 14873.00000    3.23   0.0012 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil sxl_ds dsr___
## fertile     -0.102                     
## sexual_desr  0.022 -0.670              
## dsrblty_f__  0.056 -0.001 -0.004       
## sxl_dsr:___ -0.006  0.009  0.026 -0.057</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ fertile + sexual_desire * desirability_of_partner_m + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ fertile + sexual_desire * desirability_of_partner_m +      (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46123
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.659 -0.659  0.007  0.663  3.912 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.18     1.08    
##  Residual             1.13     1.06    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                                            Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                                 0.03022     0.04968   513.00000    0.61   0.5433    
## fertile                                    -0.00781     0.02583 14820.00000   -0.30   0.7625    
## sexual_desire                               0.49002     0.01723 14988.00000   28.45   &lt;2e-16 ***
## desirability_of_partner_m                  -0.06335     0.04737   501.00000   -1.34   0.1817    
## sexual_desire:desirability_of_partner_m    -0.03635     0.01235 14873.00000   -2.94   0.0032 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil sxl_ds dsr___
## fertile     -0.102                     
## sexual_desr  0.022 -0.670              
## dsrblty_f__  0.056 -0.001 -0.004       
## sxl_dsr:___ -0.006  0.009  0.026 -0.057</code></pre>
</div>
<div id="observed-patterns" class="section level4">
<h4>Observed patterns</h4>
<p>We can observe the main effects of the fertile window.</p>
<pre class="r"><code>summary(lmer(ep_desire ~ fertile + (1 | person), sim)) # seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 47065
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.068 -0.669  0.003  0.656  4.496 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.25     1.12    
##  Residual             1.20     1.10    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##               Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)    -0.0428     0.0512   513.0000   -0.84      0.4    
## fertile         0.4938     0.0198 14530.0000   24.97   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##         (Intr)
## fertile -0.118</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ fertile + (1 | person), sim)) # seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46909
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.836 -0.666  0.001  0.648  4.080 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.23     1.11    
##  Residual             1.19     1.09    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)     0.00171     0.05074   513.00000    0.03     0.97    
## fertile         0.48684     0.01968 14530.00000   24.74   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##         (Intr)
## fertile -0.118</code></pre>
<p>We ran the following analyses to test whether the effects were independent.</p>
<pre class="r"><code>summary(lmer(ip_desire ~ ep_desire + fertile + (1 | person), sim)) # doable</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ ep_desire + fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46836
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.751 -0.669  0.004  0.656  4.154 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.07     1.03    
##  Residual             1.19     1.09    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)    -0.00147     0.04745   486.00000   -0.03     0.98    
## ep_desire      -0.07485     0.00810 14985.00000   -9.24   &lt;2e-16 ***
## fertile         0.52374     0.02007 14547.00000   26.09   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##           (Intr) ep_dsr
## ep_desire  0.007       
## fertile   -0.125 -0.199</code></pre>
<pre class="r"><code>summary(lmer(ep_desire ~ ip_desire + fertile + (1 | person), sim)) # doable</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ ip_desire + fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46993
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.031 -0.663  0.008  0.658  4.620 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.09     1.04    
##  Residual             1.20     1.10    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)    -0.04268     0.04790   486.00000   -0.89     0.37    
## ip_desire      -0.07536     0.00819 14988.00000   -9.21   &lt;2e-16 ***
## fertile         0.53053     0.02017 14549.00000   26.31   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##           (Intr) ip_dsr
## ip_desire  0.000       
## fertile   -0.123 -0.198</code></pre>
<pre class="r"><code>summary(lmer(ep_desire ~ fertile * ip_desire + (1 | person), sim)) # doable</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ fertile * ip_desire + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46737
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.069 -0.660  0.001  0.662  4.805 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.10     1.05    
##  Residual             1.18     1.09    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                      Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)          -0.04302     0.04802   486.00000   -0.90     0.37    
## fertile               0.58615     0.02028 14544.00000   28.91   &lt;2e-16 ***
## ip_desire             0.00323     0.00942 14985.00000    0.34     0.73    
## fertile:ip_desire    -0.19428     0.01193 14514.00000  -16.28   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil ip_dsr
## fertile     -0.120              
## ip_desire    0.000 -0.082       
## fertl:p_dsr  0.000 -0.170 -0.508</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ fertile * ep_desire + (1 | person), sim)) # doable</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ fertile * ep_desire + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46598
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.738 -0.669  0.004  0.646  4.235 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.07     1.04    
##  Residual             1.17     1.08    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                       Estimate   Std. Error           df t value Pr(&gt;|t|)    
## (Intercept)           0.001696     0.047564   486.000000    0.04     0.97    
## fertile               0.571269     0.020133 14543.000000   28.37   &lt;2e-16 ***
## ep_desire             0.000716     0.009342 14988.000000    0.08     0.94    
## fertile:ep_desire    -0.185176     0.011784 14514.000000  -15.71   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil ep_dsr
## fertile     -0.122              
## ep_desire    0.008 -0.092       
## fertl:p_dsr -0.004 -0.151 -0.510</code></pre>
<pre class="r"><code># doable in theory, if we knew the moderator
summary(lmer(ep_desire ~ fertile + desirability_of_partner_m * ip_desire + (1 | person), sim))</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ fertile + desirability_of_partner_m * ip_desire +      (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 47003
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.030 -0.664  0.007  0.657  4.606 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.09     1.04    
##  Residual             1.20     1.10    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                                        Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                            -0.03848     0.04796   485.00000   -0.80     0.42    
## fertile                                 0.53056     0.02017 14547.00000   26.31   &lt;2e-16 ***
## desirability_of_partner_m               0.06575     0.04562   470.00000    1.44     0.15    
## ip_desire                              -0.07483     0.00821 14984.00000   -9.12   &lt;2e-16 ***
## desirability_of_partner_m:ip_desire     0.00534     0.00787 14995.00000    0.68     0.50    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil dsr___ ip_dsr
## fertile     -0.123                     
## dsrblty_f__  0.056 -0.005              
## ip_desire    0.001 -0.196  0.011       
## dsrblt___:_  0.009  0.012 -0.013  0.075</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ fertile + desirability_of_partner_m * ep_desire + (1 | person), sim))</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ fertile + desirability_of_partner_m * ep_desire +      (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 46846
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.751 -0.669  0.004  0.656  4.149 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.07     1.03    
##  Residual             1.19     1.09    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                                          Estimate    Std. Error            df t value Pr(&gt;|t|)    
## (Intercept)                            -0.0051999     0.0474866   485.0000000   -0.11     0.91    
## fertile                                 0.5237700     0.0200755 14547.0000000   26.09   &lt;2e-16 ***
## desirability_of_partner_m              -0.0631964     0.0451750   470.0000000   -1.40     0.16    
## ep_desire                              -0.0747598     0.0081081 14982.0000000   -9.22   &lt;2e-16 ***
## desirability_of_partner_m:ep_desire    -0.0000584     0.0077185 14993.0000000   -0.01     0.99    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil dsr___ ep_dsr
## fertile     -0.125                     
## dsrblty_f__  0.056  0.001              
## ep_desire    0.006 -0.200 -0.014       
## dsrblt___:_ -0.012 -0.020 -0.023  0.043</code></pre>
</div>
</div>
<div id="forward-simulation-scenario-2-target-specific-desire" class="section level3">
<h3>Forward-simulation, scenario 2, target-specific desire</h3>
<p>Here, we simulate 500 women, measured on 30 days each. Here, the fertile window only has independent effects on extra-pair and in-pair desire.</p>
<pre class="r"><code>library(dplyr)
library(ggplot2)
library(effects)
library(lme4)

yn = c(0,1)
n_person = 500
days = 30
n = n_person * days
persons = data_frame(
  person = 1:n_person,
  basic_sexual_desire = rnorm(n_person),
  desirability_of_partner = rnorm(n_person),
  desirability_of_partner_m = rnorm(n_person) + rnorm(n_person) / 3
)
sim = data_frame(
  person = rep(1:500, each = days),
    fertile = sample(yn, size = n, replace = T, prob = c(0.7, 0.3))
) %&gt;% 
  full_join(persons, by = &#39;person&#39;) %&gt;% 
mutate(
    sexual_desire = basic_sexual_desire/2  + rnorm(n)/2,
    ep_desire = basic_sexual_desire/2  + rnorm(n) + 1 * fertile + -1 * desirability_of_partner,
    ip_desire = basic_sexual_desire/2  + rnorm(n) + 1 * fertile + desirability_of_partner
)</code></pre>
<div id="unobserved-patterns-1" class="section level4">
<h4>Unobserved patterns</h4>
<p>In our data, we cannot run this test, which shows that the effect of fertile on EP/IP desire is independent of sexual desire.</p>
<pre class="r"><code>summary(lmer(sexual_desire ~ fertile + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: sexual_desire ~ fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 23753
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.847 -0.664  0.001  0.653  3.888 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.261    0.511   
##  Residual             0.254    0.504   
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                Estimate  Std. Error          df t value Pr(&gt;|t|)
## (Intercept)    -0.00035     0.02339   513.00000   -0.01     0.99
## fertile        -0.01311     0.00913 14534.00000   -1.44     0.15
## 
## Correlation of Fixed Effects:
##         (Intr)
## fertile -0.118</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ sexual_desire + fertile + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ sexual_desire + fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44329
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.683 -0.675 -0.013  0.669  3.650 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.273    1.128   
##  Residual             0.994    0.997   
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                 Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)       0.0325     0.0514   506.0000    0.63     0.53    
## sexual_desire     0.0241     0.0162 14979.0000    1.49     0.14    
## fertile           0.9931     0.0181 14522.0000   55.00   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) sxl_ds
## sexual_desr  0.000       
## fertile     -0.106  0.012</code></pre>
<pre class="r"><code>summary(lmer(ep_desire ~ sexual_desire + fertile + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ sexual_desire + fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44697
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.702 -0.667  0.008  0.662  3.915 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.31     1.14    
##  Residual             1.02     1.01    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                 Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)      -0.0181     0.0520   505.0000   -0.35    0.728    
## sexual_desire     0.0419     0.0164 14979.0000    2.56    0.011 *  
## fertile           1.0074     0.0183 14522.0000   55.10   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) sxl_ds
## sexual_desr  0.000       
## fertile     -0.106  0.012</code></pre>
<pre class="r"><code>summary(lmer(ep_desire ~ fertile + sexual_desire * desirability_of_partner_m + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ fertile + sexual_desire * desirability_of_partner_m +      (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44704
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.701 -0.667  0.006  0.661  3.915 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.31     1.14    
##  Residual             1.02     1.01    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                                           Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)                                -0.0162     0.0522   504.0000   -0.31    0.757    
## fertile                                     1.0077     0.0183 14521.0000   55.12   &lt;2e-16 ***
## sexual_desire                               0.0393     0.0165 14976.0000    2.39    0.017 *  
## desirability_of_partner_m                   0.0295     0.0520   493.0000    0.57    0.570    
## sexual_desire:desirability_of_partner_m    -0.0311     0.0164 14967.0000   -1.89    0.058 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil sxl_ds dsr___
## fertile     -0.106                     
## sexual_desr  0.000  0.011              
## dsrblty_f__  0.065  0.001  0.000       
## sxl_dsr:___  0.001 -0.009  0.083  0.012</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ fertile + sexual_desire * desirability_of_partner_m + (1 | person), sim)) # not seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ fertile + sexual_desire * desirability_of_partner_m +      (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44339
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.675 -0.674 -0.013  0.669  3.651 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.276    1.129   
##  Residual             0.994    0.997   
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                                             Estimate   Std. Error           df t value Pr(&gt;|t|)    
## (Intercept)                                 0.032520     0.051565   505.000000    0.63     0.53    
## fertile                                     0.993256     0.018059 14521.000000   55.00   &lt;2e-16 ***
## sexual_desire                               0.023010     0.016263 14976.000000    1.41     0.16    
## desirability_of_partner_m                   0.000398     0.051355   494.000000    0.01     0.99    
## sexual_desire:desirability_of_partner_m    -0.012715     0.016212 14967.000000   -0.78     0.43    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil sxl_ds dsr___
## fertile     -0.106                     
## sexual_desr  0.000  0.011              
## dsrblty_f__  0.065  0.001  0.000       
## sxl_dsr:___  0.001 -0.009  0.083  0.012</code></pre>
</div>
<div id="observed-patterns-1" class="section level4">
<h4>Observed patterns</h4>
<p>We can observe the main effects of the fertile window.</p>
<pre class="r"><code>summary(lmer(ep_desire ~ fertile + (1 | person), sim)) # seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44698
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.703 -0.667  0.007  0.663  3.924 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.33     1.15    
##  Residual             1.02     1.01    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##               Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)    -0.0181     0.0525   510.0000   -0.34     0.73    
## fertile         1.0068     0.0183 14527.0000   55.08   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##         (Intr)
## fertile -0.105</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ fertile + (1 | person), sim)) # seen</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44325
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.700 -0.677 -0.015  0.667  3.633 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.285    1.134   
##  Residual             0.994    0.997   
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##               Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)     0.0325     0.0516   510.0000    0.63     0.53    
## fertile         0.9928     0.0181 14527.0000   54.99   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##         (Intr)
## fertile -0.106</code></pre>
<p>We <a href="3_fertility_robustness.html#just-libido">ran the following analyses on the real data</a> to test whether the effects were independent.</p>
<pre class="r"><code>summary(lmer(ip_desire ~ ep_desire + fertile + (1 | person), sim)) # doable</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ ep_desire + fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44330
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.698 -0.677 -0.013  0.669  3.635 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.264    1.124   
##  Residual             0.994    0.997   
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)     0.03225     0.05123   499.00000    0.63    0.529    
## ep_desire      -0.01353     0.00806 14997.00000   -1.68    0.093 .  
## fertile         1.00644     0.01980 14666.00000   50.83   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##           (Intr) ep_dsr
## ep_desire  0.003       
## fertile   -0.098 -0.410</code></pre>
<pre class="r"><code>summary(lmer(ep_desire ~ ip_desire + fertile + (1 | person), sim)) # doable</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ ip_desire + fertile + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44703
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.686 -0.664  0.005  0.662  3.923 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.31     1.14    
##  Residual             1.02     1.01    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)    -0.01766     0.05209   500.00000   -0.34    0.735    
## ip_desire      -0.01371     0.00827 14997.00000   -1.66    0.097 .  
## fertile         1.02041     0.02004 14664.00000   50.92   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##           (Intr) ip_dsr
## ip_desire -0.005       
## fertile   -0.095 -0.410</code></pre>
<pre class="r"><code>summary(lmer(ep_desire ~ fertile * ip_desire + (1 | person), sim)) # doable</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ fertile * ip_desire + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44710
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.689 -0.664  0.005  0.661  3.925 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.31     1.14    
##  Residual             1.02     1.01    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                      Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)          -0.01770     0.05209   500.00000   -0.34     0.73    
## fertile               1.02317     0.02180 14641.00000   46.92   &lt;2e-16 ***
## ip_desire            -0.01252     0.00906 14983.00000   -1.38     0.17    
## fertile:ip_desire    -0.00386     0.01201 14508.00000   -0.32     0.75    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil ip_dsr
## fertile     -0.088              
## ip_desire   -0.006 -0.183       
## fertl:p_dsr  0.003 -0.394 -0.408</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ fertile * ep_desire + (1 | person), sim)) # doable</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ fertile * ep_desire + (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44337
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.697 -0.677 -0.013  0.668  3.636 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.264    1.124   
##  Residual             0.994    0.997   
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                      Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)           0.03226     0.05123   499.00000    0.63     0.53    
## fertile               1.00752     0.02139 14643.00000   47.10   &lt;2e-16 ***
## ep_desire            -0.01306     0.00881 14987.00000   -1.48     0.14    
## fertile:ep_desire    -0.00157     0.01182 14512.00000   -0.13     0.89    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil ep_dsr
## fertile     -0.091              
## ep_desire    0.003 -0.195       
## fertl:p_dsr -0.001 -0.379 -0.403</code></pre>
<p>These more informative analyses could only be run if we knew the moderator.</p>
<pre class="r"><code># doable in theory, if we knew the moderator
summary(lmer(ep_desire ~ fertile + desirability_of_partner_m * ip_desire + (1 | person), sim))</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ep_desire ~ fertile + desirability_of_partner_m * ip_desire +      (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44713
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.680 -0.663  0.007  0.662  3.923 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.31     1.14    
##  Residual             1.02     1.01    
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                                        Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                            -0.01574     0.05224   498.00000   -0.30     0.76    
## fertile                                 1.02034     0.02004 14663.00000   50.92   &lt;2e-16 ***
## desirability_of_partner_m               0.02823     0.05206   489.00000    0.54     0.59    
## ip_desire                              -0.01310     0.00828 14995.00000   -1.58     0.11    
## desirability_of_partner_m:ip_desire     0.00978     0.00758 14968.00000    1.29     0.20    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil dsr___ ip_dsr
## fertile     -0.094                     
## dsrblty_f__  0.065  0.001              
## ip_desire   -0.005 -0.409 -0.002       
## dsrblt___:_ -0.001 -0.002 -0.038  0.054</code></pre>
<pre class="r"><code>summary(lmer(ip_desire ~ fertile + desirability_of_partner_m * ep_desire + (1 | person), sim))</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: ip_desire ~ fertile + desirability_of_partner_m * ep_desire +      (1 | person)
##    Data: sim
## 
## REML criterion at convergence: 44339
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.690 -0.680 -0.013  0.666  3.629 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 1.268    1.126   
##  Residual             0.994    0.997   
## Number of obs: 15000, groups:  person, 500
## 
## Fixed effects:
##                                        Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                             0.03182     0.05141   498.00000    0.62     0.54    
## fertile                                 1.00652     0.01980 14664.00000   50.84   &lt;2e-16 ***
## desirability_of_partner_m              -0.00170     0.05123   489.00000   -0.03     0.97    
## ep_desire                              -0.01285     0.00807 14995.00000   -1.59     0.11    
## desirability_of_partner_m:ep_desire     0.01154     0.00735 14961.00000    1.57     0.12    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) fertil dsr___ ep_dsr
## fertile     -0.098                     
## dsrblty_f__  0.066  0.003              
## ep_desire    0.002 -0.409 -0.007       
## dsrblt___:_ -0.006  0.004 -0.038  0.050</code></pre>
</div>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
